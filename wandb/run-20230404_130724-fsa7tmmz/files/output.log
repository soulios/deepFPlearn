WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
Epoch 1/10
2023-04-04 13:07:43.558717: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-04 13:07:43.558987: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-04 13:07:43.580038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-04 13:07:43.581072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-04 13:07:43.582010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-04 13:07:43.582920: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-04 13:07:43.610776: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.037ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
2023-04-04 13:07:43.869082: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-04-04 13:07:49.862647: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 7s - loss: 0.5135 - accuracy: 0.8074 - auc: 0.5228 - precision: 0.2018 - recall: 0.0260 - balanced_accuracy: 0.5005 - val_loss: 0.4459 - val_accuracy: 0.8218 - val_auc: 0.6632 - val_precision: 0.5714 - val_recall: 0.0189 - val_balanced_accuracy: 0.5076
Epoch 2/10
37/37 - 0s - loss: 0.4900 - accuracy: 0.8044 - auc: 0.5816 - precision: 0.2818 - recall: 0.0602 - balanced_accuracy: 0.5136 - val_loss: 0.4193 - val_accuracy: 0.8302 - val_auc: 0.7295 - val_precision: 0.7619 - val_recall: 0.0755 - val_balanced_accuracy: 0.5321
Epoch 3/10
37/37 - 0s - loss: 0.4698 - accuracy: 0.8135 - auc: 0.6175 - precision: 0.4062 - recall: 0.0921 - balanced_accuracy: 0.5327 - val_loss: 0.4019 - val_accuracy: 0.8429 - val_auc: 0.7602 - val_precision: 0.8421 - val_recall: 0.1509 - val_balanced_accuracy: 0.5660
Epoch 4/10
37/37 - 0s - loss: 0.4540 - accuracy: 0.8232 - auc: 0.6487 - precision: 0.5266 - recall: 0.1169 - balanced_accuracy: 0.5469 - val_loss: 0.3893 - val_accuracy: 0.8480 - val_auc: 0.7793 - val_precision: 0.8200 - val_recall: 0.1934 - val_balanced_accuracy: 0.6059
Epoch 5/10
37/37 - 0s - loss: 0.4415 - accuracy: 0.8329 - auc: 0.6682 - precision: 0.6157 - recall: 0.1759 - balanced_accuracy: 0.5769 - val_loss: 0.3802 - val_accuracy: 0.8514 - val_auc: 0.7930 - val_precision: 0.8103 - val_recall: 0.2217 - val_balanced_accuracy: 0.6180
Epoch 6/10
37/37 - 0s - loss: 0.4265 - accuracy: 0.8340 - auc: 0.6998 - precision: 0.6380 - recall: 0.1665 - balanced_accuracy: 0.5736 - val_loss: 0.3724 - val_accuracy: 0.8530 - val_auc: 0.8022 - val_precision: 0.8065 - val_recall: 0.2358 - val_balanced_accuracy: 0.6242
Epoch 7/10
37/37 - 0s - loss: 0.4119 - accuracy: 0.8397 - auc: 0.7311 - precision: 0.6803 - recall: 0.1960 - balanced_accuracy: 0.5879 - val_loss: 0.3658 - val_accuracy: 0.8556 - val_auc: 0.8093 - val_precision: 0.8060 - val_recall: 0.2547 - val_balanced_accuracy: 0.6318
Epoch 8/10
37/37 - 0s - loss: 0.4096 - accuracy: 0.8435 - auc: 0.7272 - precision: 0.7103 - recall: 0.2113 - balanced_accuracy: 0.5986 - val_loss: 0.3611 - val_accuracy: 0.8581 - val_auc: 0.8149 - val_precision: 0.8143 - val_recall: 0.2689 - val_balanced_accuracy: 0.6379
Epoch 9/10
37/37 - 0s - loss: 0.4070 - accuracy: 0.8427 - auc: 0.7340 - precision: 0.6875 - recall: 0.2208 - balanced_accuracy: 0.6007 - val_loss: 0.3558 - val_accuracy: 0.8632 - val_auc: 0.8215 - val_precision: 0.8289 - val_recall: 0.2972 - val_balanced_accuracy: 0.6737
Epoch 10/10
37/37 - 0s - loss: 0.4034 - accuracy: 0.8393 - auc: 0.7437 - precision: 0.6463 - recall: 0.2243 - balanced_accuracy: 0.5980 - val_loss: 0.3525 - val_accuracy: 0.8640 - val_auc: 0.8242 - val_precision: 0.8312 - val_recall: 0.3019 - val_balanced_accuracy: 0.6757
Epoch 00010: val_loss improved from inf to 0.35249, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
<IPython.core.display.HTML object>
('You must install pydot (`pip install pydot`) and install graphviz (see instructions at https://graphviz.gitlab.io/download/) ', 'for plot_model/model_to_dot to work.')
[ True  True  True ...  True  True  True]
<bound method Model.predict of <keras.engine.sequential.Sequential object at 0x2abb27991850>>
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 1 0 ... 0 0 0]
 ...
 [0 1 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
<class 'numpy.ndarray'>	4735
<class 'tuple'>	2
'Kernel' object has no attribute 'masker'
usage: deepFPlearn [-h] {traingnn,predictgnn,train,predict,convert} ...
INFO     Computation time for training the single-label model for AR: 0.2 min
WARNING  Using 4735 background data samples could cause slower run times. Consider using shap.sample(data, K) or shap.kmeans(data, K) to summarize the background as K samples.