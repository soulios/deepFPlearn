WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
Epoch 1/10
2023-04-04 10:09:12.091404: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-04 10:09:12.091667: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-04 10:09:12.143172: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-04 10:09:12.145153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-04 10:09:12.149741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-04 10:09:12.151474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-04 10:09:12.183670: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.056ms.
  function_optimizer: function_optimizer did nothing. time = 0.004ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
2023-04-04 10:09:12.436082: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-04-04 10:09:18.539842: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 7s - loss: 0.4922 - accuracy: 0.8114 - auc: 0.5480 - precision: 0.2500 - recall: 0.0272 - balanced_accuracy: 0.5043 - val_loss: 0.4486 - val_accuracy: 0.8218 - val_auc: 0.6335 - val_precision: 1.0000 - val_recall: 0.0047 - val_balanced_accuracy: 0.5017
Epoch 2/10
37/37 - 0s - loss: 0.4730 - accuracy: 0.8184 - auc: 0.5923 - precision: 0.4369 - recall: 0.0531 - balanced_accuracy: 0.5189 - val_loss: 0.4297 - val_accuracy: 0.8361 - val_auc: 0.6821 - val_precision: 0.9500 - val_recall: 0.0896 - val_balanced_accuracy: 0.5419
Epoch 3/10
37/37 - 0s - loss: 0.4581 - accuracy: 0.8234 - auc: 0.6310 - precision: 0.5414 - recall: 0.0850 - balanced_accuracy: 0.5335 - val_loss: 0.4172 - val_accuracy: 0.8480 - val_auc: 0.7067 - val_precision: 0.9706 - val_recall: 0.1557 - val_balanced_accuracy: 0.5725
Epoch 4/10
37/37 - 0s - loss: 0.4433 - accuracy: 0.8260 - auc: 0.6640 - precision: 0.5665 - recall: 0.1157 - balanced_accuracy: 0.5486 - val_loss: 0.4076 - val_accuracy: 0.8539 - val_auc: 0.7257 - val_precision: 0.9535 - val_recall: 0.1934 - val_balanced_accuracy: 0.5887
Epoch 5/10
37/37 - 0s - loss: 0.4276 - accuracy: 0.8344 - auc: 0.6947 - precision: 0.6909 - recall: 0.1346 - balanced_accuracy: 0.5605 - val_loss: 0.4003 - val_accuracy: 0.8530 - val_auc: 0.7373 - val_precision: 0.9130 - val_recall: 0.1981 - val_balanced_accuracy: 0.5897
Epoch 6/10
37/37 - 0s - loss: 0.4113 - accuracy: 0.8412 - auc: 0.7274 - precision: 0.7230 - recall: 0.1818 - balanced_accuracy: 0.5832 - val_loss: 0.3940 - val_accuracy: 0.8530 - val_auc: 0.7473 - val_precision: 0.8519 - val_recall: 0.2170 - val_balanced_accuracy: 0.6033
Epoch 7/10
37/37 - 0s - loss: 0.4133 - accuracy: 0.8433 - auc: 0.7197 - precision: 0.7313 - recall: 0.1960 - balanced_accuracy: 0.5899 - val_loss: 0.3888 - val_accuracy: 0.8505 - val_auc: 0.7578 - val_precision: 0.8070 - val_recall: 0.2170 - val_balanced_accuracy: 0.6019
Epoch 8/10
37/37 - 0s - loss: 0.4007 - accuracy: 0.8427 - auc: 0.7492 - precision: 0.7073 - recall: 0.2054 - balanced_accuracy: 0.5939 - val_loss: 0.3842 - val_accuracy: 0.8505 - val_auc: 0.7642 - val_precision: 0.7778 - val_recall: 0.2311 - val_balanced_accuracy: 0.6078
Epoch 9/10
37/37 - 0s - loss: 0.3947 - accuracy: 0.8450 - auc: 0.7576 - precision: 0.7306 - recall: 0.2113 - balanced_accuracy: 0.5981 - val_loss: 0.3802 - val_accuracy: 0.8522 - val_auc: 0.7711 - val_precision: 0.7761 - val_recall: 0.2453 - val_balanced_accuracy: 0.6122
Epoch 10/10
37/37 - 0s - loss: 0.3861 - accuracy: 0.8475 - auc: 0.7710 - precision: 0.7395 - recall: 0.2279 - balanced_accuracy: 0.6056 - val_loss: 0.3772 - val_accuracy: 0.8488 - val_auc: 0.7764 - val_precision: 0.7260 - val_recall: 0.2500 - val_balanced_accuracy: 0.6116
Epoch 00010: val_loss improved from inf to 0.37719, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for AR: 0.2 min
<IPython.core.display.HTML object>
<class 'tuple'>	(1884,)	(1884,)
<class 'tuple'>	1
'int' object has no attribute 'shape'
usage: deepFPlearn [-h] {traingnn,predictgnn,train,predict,convert} ...