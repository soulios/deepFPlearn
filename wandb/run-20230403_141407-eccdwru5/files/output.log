WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:14:28.785681: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:14:28.785944: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:14:28.805191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:14:28.806150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:14:28.807098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:14:28.808124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:14:28.832750: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.031ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
Epoch 1/10
2023-04-03 14:14:29.101540: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-04-03 14:14:35.468424: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 7s - loss: 0.5163 - accuracy: 0.7949 - auc: 0.5278 - precision: 0.2156 - recall: 0.0555 - balanced_accuracy: 0.5054 - val_loss: 0.4646 - val_accuracy: 0.8260 - val_auc: 0.5774 - val_precision: 0.8750 - val_recall: 0.0330 - val_balanced_accuracy: 0.5147
Epoch 2/10
37/37 - 0s - loss: 0.4755 - accuracy: 0.8080 - auc: 0.6098 - precision: 0.3495 - recall: 0.0850 - balanced_accuracy: 0.5260 - val_loss: 0.4408 - val_accuracy: 0.8328 - val_auc: 0.6569 - val_precision: 0.8889 - val_recall: 0.0755 - val_balanced_accuracy: 0.5341
Epoch 3/10
37/37 - 0s - loss: 0.4658 - accuracy: 0.8203 - auc: 0.6249 - precision: 0.4918 - recall: 0.1417 - balanced_accuracy: 0.5545 - val_loss: 0.4264 - val_accuracy: 0.8361 - val_auc: 0.6902 - val_precision: 0.8214 - val_recall: 0.1085 - val_balanced_accuracy: 0.5490
Epoch 4/10
37/37 - 0s - loss: 0.4378 - accuracy: 0.8332 - auc: 0.6734 - precision: 0.6508 - recall: 0.1452 - balanced_accuracy: 0.5639 - val_loss: 0.4151 - val_accuracy: 0.8429 - val_auc: 0.7132 - val_precision: 0.8421 - val_recall: 0.1509 - val_balanced_accuracy: 0.5680
Epoch 5/10
37/37 - 0s - loss: 0.4355 - accuracy: 0.8300 - auc: 0.6813 - precision: 0.5820 - recall: 0.1759 - balanced_accuracy: 0.5770 - val_loss: 0.4053 - val_accuracy: 0.8471 - val_auc: 0.7320 - val_precision: 0.8298 - val_recall: 0.1840 - val_balanced_accuracy: 0.5828
Epoch 6/10
37/37 - 0s - loss: 0.4251 - accuracy: 0.8338 - auc: 0.6989 - precision: 0.6240 - recall: 0.1783 - balanced_accuracy: 0.5787 - val_loss: 0.3983 - val_accuracy: 0.8480 - val_auc: 0.7445 - val_precision: 0.7857 - val_recall: 0.2075 - val_balanced_accuracy: 0.6024
Epoch 7/10
37/37 - 0s - loss: 0.4091 - accuracy: 0.8382 - auc: 0.7296 - precision: 0.6528 - recall: 0.2043 - balanced_accuracy: 0.5890 - val_loss: 0.3924 - val_accuracy: 0.8505 - val_auc: 0.7550 - val_precision: 0.7966 - val_recall: 0.2217 - val_balanced_accuracy: 0.6093
Epoch 8/10
37/37 - 0s - loss: 0.4040 - accuracy: 0.8395 - auc: 0.7437 - precision: 0.6505 - recall: 0.2220 - balanced_accuracy: 0.5993 - val_loss: 0.3870 - val_accuracy: 0.8480 - val_auc: 0.7631 - val_precision: 0.7581 - val_recall: 0.2217 - val_balanced_accuracy: 0.6078
Epoch 9/10
37/37 - 0s - loss: 0.3989 - accuracy: 0.8429 - auc: 0.7468 - precision: 0.6873 - recall: 0.2231 - balanced_accuracy: 0.6014 - val_loss: 0.3826 - val_accuracy: 0.8505 - val_auc: 0.7714 - val_precision: 0.7692 - val_recall: 0.2358 - val_balanced_accuracy: 0.6131
Epoch 10/10
37/37 - 0s - loss: 0.3919 - accuracy: 0.8505 - auc: 0.7531 - precision: 0.7264 - recall: 0.2633 - balanced_accuracy: 0.6207 - val_loss: 0.3787 - val_accuracy: 0.8530 - val_auc: 0.7765 - val_precision: 0.7794 - val_recall: 0.2500 - val_balanced_accuracy: 0.6206
Epoch 00010: val_loss improved from inf to 0.37866, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for AR: 0.21 min
<IPython.core.display.HTML object>












































































Permutation explainer: 1897it [02:44, 11.00it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'AR single-labeled Fold-0' on test data
37/37 [==============================] - 1s 8ms/step - loss: 0.5372 - accuracy: 0.8074 - auc: 0.5278 - precision: 0.3333 - recall: 0.0755 - balanced_accuracy: 0.5162
INFO     Loss: 0.5372
INFO     Accuracy: 0.8074
INFO     AUC: 0.5278
INFO     Precision: 0.3333
INFO     Recall: 0.0755
INFO     Balanced Accuracy: 0.5162
INFO     MCC: 0.0827
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
2023-04-03 14:17:30.318468: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5590 valid entries in fp and ER
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4252, 1.0: 1338}
INFO     X training matrix of shape (5590, 2048) and type bool
INFO     Y training matrix of shape (5590,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -1.1567048454998552
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:17:31.542330: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:17:31.542605: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:17:31.582772: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:17:31.586105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:17:31.587713: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:17:31.589265: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:17:31.600293: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.015ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
Epoch 1/10
35/35 - 2s - loss: 0.5855 - accuracy: 0.7323 - auc_2: 0.5342 - precision_2: 0.3022 - recall_2: 0.0907 - balanced_accuracy: 0.5136 - val_loss: 0.5279 - val_accuracy: 0.7657 - val_auc_2: 0.6405 - val_precision_2: 1.0000 - val_recall_2: 0.0224 - val_balanced_accuracy: 0.5101
Epoch 2/10
35/35 - 0s - loss: 0.5590 - accuracy: 0.7419 - auc_2: 0.5891 - precision_2: 0.3636 - recall_2: 0.1047 - balanced_accuracy: 0.5223 - val_loss: 0.5044 - val_accuracy: 0.7728 - val_auc_2: 0.7037 - val_precision_2: 0.8182 - val_recall_2: 0.0672 - val_balanced_accuracy: 0.5308
Epoch 3/10
35/35 - 0s - loss: 0.5364 - accuracy: 0.7578 - auc_2: 0.6345 - precision_2: 0.4788 - recall_2: 0.1374 - balanced_accuracy: 0.5445 - val_loss: 0.4881 - val_accuracy: 0.7835 - val_auc_2: 0.7350 - val_precision_2: 0.8421 - val_recall_2: 0.1194 - val_balanced_accuracy: 0.5550
Epoch 4/10
35/35 - 0s - loss: 0.5211 - accuracy: 0.7672 - auc_2: 0.6670 - precision_2: 0.5383 - recall_2: 0.1907 - balanced_accuracy: 0.5710 - val_loss: 0.4764 - val_accuracy: 0.7916 - val_auc_2: 0.7517 - val_precision_2: 0.8182 - val_recall_2: 0.1679 - val_balanced_accuracy: 0.5766
Epoch 5/10
35/35 - 0s - loss: 0.5072 - accuracy: 0.7746 - auc_2: 0.6893 - precision_2: 0.5783 - recall_2: 0.2140 - balanced_accuracy: 0.5847 - val_loss: 0.4669 - val_accuracy: 0.8023 - val_auc_2: 0.7636 - val_precision_2: 0.8406 - val_recall_2: 0.2164 - val_balanced_accuracy: 0.5993
Epoch 6/10
35/35 - 0s - loss: 0.5000 - accuracy: 0.7753 - auc_2: 0.7068 - precision_2: 0.5744 - recall_2: 0.2346 - balanced_accuracy: 0.5900 - val_loss: 0.4577 - val_accuracy: 0.8032 - val_auc_2: 0.7751 - val_precision_2: 0.8000 - val_recall_2: 0.2388 - val_balanced_accuracy: 0.6066
Epoch 7/10
35/35 - 0s - loss: 0.4841 - accuracy: 0.7876 - auc_2: 0.7253 - precision_2: 0.6327 - recall_2: 0.2673 - balanced_accuracy: 0.6103 - val_loss: 0.4505 - val_accuracy: 0.7996 - val_auc_2: 0.7836 - val_precision_2: 0.7444 - val_recall_2: 0.2500 - val_balanced_accuracy: 0.6081
Epoch 8/10
35/35 - 0s - loss: 0.4841 - accuracy: 0.7849 - auc_2: 0.7228 - precision_2: 0.6195 - recall_2: 0.2617 - balanced_accuracy: 0.6053 - val_loss: 0.4442 - val_accuracy: 0.8023 - val_auc_2: 0.7907 - val_precision_2: 0.7327 - val_recall_2: 0.2761 - val_balanced_accuracy: 0.6178
Epoch 9/10
35/35 - 0s - loss: 0.4716 - accuracy: 0.7934 - auc_2: 0.7456 - precision_2: 0.6443 - recall_2: 0.3047 - balanced_accuracy: 0.6258 - val_loss: 0.4390 - val_accuracy: 0.8041 - val_auc_2: 0.7969 - val_precision_2: 0.7248 - val_recall_2: 0.2948 - val_balanced_accuracy: 0.6263
Epoch 10/10
35/35 - 0s - loss: 0.4681 - accuracy: 0.7972 - auc_2: 0.7512 - precision_2: 0.6653 - recall_2: 0.3065 - balanced_accuracy: 0.6295 - val_loss: 0.4339 - val_accuracy: 0.8059 - val_auc_2: 0.8014 - val_precision_2: 0.7383 - val_recall_2: 0.2948 - val_balanced_accuracy: 0.6271
Epoch 00010: val_loss improved from inf to 0.43395, saving model to /home/zadubrov/output/results_train/ER_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for ER: 0.11 min






































































Permutation explainer: 1810it [02:31, 11.20it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'ER single-labeled Fold-0' on test data
35/35 [==============================] - 1s 9ms/step - loss: 0.5951 - accuracy: 0.7513 - auc: 0.5219 - precision: 0.4265 - recall: 0.1082 - balanced_accuracy: 0.5323
INFO     Loss: 0.5951
INFO     Accuracy: 0.7513
INFO     AUC: 0.5219
INFO     Precision: 0.4265
INFO     Recall: 0.1082
INFO     Balanced Accuracy: 0.5323
INFO     MCC: 0.1113
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6055 valid entries in fp and GR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5454, 1.0: 601}
INFO     X training matrix of shape (6055, 2048) and type bool
INFO     Y training matrix of shape (6055,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.2050479030178485
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:20:12.600049: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:20:12.600215: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:20:12.635389: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:20:12.636797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:20:12.638139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:20:12.642067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:20:12.650269: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
Epoch 1/10
38/38 - 2s - loss: 0.3443 - accuracy: 0.8995 - auc_2: 0.5308 - precision_2: 0.2500 - recall_2: 0.0062 - balanced_accuracy: 0.5025 - val_loss: 0.3088 - val_accuracy: 0.9009 - val_auc_2: 0.6183 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
38/38 - 0s - loss: 0.3269 - accuracy: 0.8999 - auc_2: 0.5954 - precision_2: 0.3889 - recall_2: 0.0146 - balanced_accuracy: 0.5070 - val_loss: 0.2891 - val_accuracy: 0.9034 - val_auc_2: 0.6729 - val_precision_2: 1.0000 - val_recall_2: 0.0250 - val_balanced_accuracy: 0.5093
Epoch 3/10
38/38 - 0s - loss: 0.3047 - accuracy: 0.9055 - auc_2: 0.6584 - precision_2: 0.7447 - recall_2: 0.0728 - balanced_accuracy: 0.5337 - val_loss: 0.2757 - val_accuracy: 0.9199 - val_auc_2: 0.7046 - val_precision_2: 1.0000 - val_recall_2: 0.1917 - val_balanced_accuracy: 0.5839
Epoch 4/10
38/38 - 0s - loss: 0.2927 - accuracy: 0.9067 - auc_2: 0.7007 - precision_2: 0.7636 - recall_2: 0.0873 - balanced_accuracy: 0.5409 - val_loss: 0.2677 - val_accuracy: 0.9224 - val_auc_2: 0.7215 - val_precision_2: 1.0000 - val_recall_2: 0.2167 - val_balanced_accuracy: 0.5970
Epoch 5/10
38/38 - 0s - loss: 0.2810 - accuracy: 0.9125 - auc_2: 0.7208 - precision_2: 0.8701 - recall_2: 0.1393 - balanced_accuracy: 0.5685 - val_loss: 0.2624 - val_accuracy: 0.9232 - val_auc_2: 0.7355 - val_precision_2: 1.0000 - val_recall_2: 0.2250 - val_balanced_accuracy: 0.6032
Epoch 6/10
38/38 - 0s - loss: 0.2768 - accuracy: 0.9137 - auc_2: 0.7269 - precision_2: 0.8316 - recall_2: 0.1642 - balanced_accuracy: 0.5856 - val_loss: 0.2587 - val_accuracy: 0.9216 - val_auc_2: 0.7455 - val_precision_2: 0.9032 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6058
Epoch 7/10
38/38 - 0s - loss: 0.2704 - accuracy: 0.9176 - auc_2: 0.7419 - precision_2: 0.8727 - recall_2: 0.1996 - balanced_accuracy: 0.5992 - val_loss: 0.2557 - val_accuracy: 0.9216 - val_auc_2: 0.7559 - val_precision_2: 0.9032 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6058
Epoch 8/10
38/38 - 0s - loss: 0.2630 - accuracy: 0.9176 - auc_2: 0.7615 - precision_2: 0.8475 - recall_2: 0.2079 - balanced_accuracy: 0.6000 - val_loss: 0.2535 - val_accuracy: 0.9207 - val_auc_2: 0.7593 - val_precision_2: 0.8750 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6053
Epoch 9/10
38/38 - 0s - loss: 0.2567 - accuracy: 0.9209 - auc_2: 0.7717 - precision_2: 0.8712 - recall_2: 0.2391 - balanced_accuracy: 0.6197 - val_loss: 0.2516 - val_accuracy: 0.9207 - val_auc_2: 0.7630 - val_precision_2: 0.8750 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6053
Epoch 10/10
38/38 - 0s - loss: 0.2507 - accuracy: 0.9220 - auc_2: 0.7891 - precision_2: 0.8759 - recall_2: 0.2495 - balanced_accuracy: 0.6167 - val_loss: 0.2504 - val_accuracy: 0.9207 - val_auc_2: 0.7693 - val_precision_2: 0.8750 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6053
Epoch 00010: val_loss improved from inf to 0.25039, saving model to /home/zadubrov/output/results_train/GR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for GR: 0.11 min








































































Permutation explainer: 1873it [02:37, 11.13it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'GR single-labeled Fold-0' on test data
INFO     Loss: 1.2737
INFO     Accuracy: 0.1107
INFO     AUC: 0.3979
INFO     Precision: 0.0955
INFO     Recall: 0.9417
INFO     Balanced Accuracy: 0.4871
INFO     MCC: -0.0777
38/38 [==============================] - 1s 9ms/step - loss: 1.2737 - accuracy: 0.1107 - auc: 0.3979 - precision: 0.0955 - recall: 0.9417 - balanced_accuracy: 0.4871
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6154 valid entries in fp and Aromatase
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5457, 1.0: 697}
INFO     X training matrix of shape (6154, 2048) and type bool
INFO     Y training matrix of shape (6154,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.0570145058923917
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:22:59.798475: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:22:59.798629: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:22:59.815031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:22:59.815962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:22:59.816925: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:22:59.817856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:22:59.823647: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
Epoch 1/10
39/39 - 2s - loss: 0.3852 - accuracy: 0.8836 - auc_2: 0.5081 - precision_2: 0.1053 - recall_2: 0.0036 - balanced_accuracy: 0.4996 - val_loss: 0.3562 - val_accuracy: 0.8871 - val_auc_2: 0.5334 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
39/39 - 0s - loss: 0.3684 - accuracy: 0.8836 - auc_2: 0.5554 - precision_2: 0.0588 - recall_2: 0.0018 - balanced_accuracy: 0.4988 - val_loss: 0.3379 - val_accuracy: 0.8871 - val_auc_2: 0.6402 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
39/39 - 0s - loss: 0.3554 - accuracy: 0.8875 - auc_2: 0.5961 - precision_2: 0.7500 - recall_2: 0.0108 - balanced_accuracy: 0.5054 - val_loss: 0.3262 - val_accuracy: 0.8871 - val_auc_2: 0.6865 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
39/39 - 0s - loss: 0.3374 - accuracy: 0.8869 - auc_2: 0.6645 - precision_2: 0.5263 - recall_2: 0.0179 - balanced_accuracy: 0.5084 - val_loss: 0.3179 - val_accuracy: 0.8887 - val_auc_2: 0.7109 - val_precision_2: 1.0000 - val_recall_2: 0.0144 - val_balanced_accuracy: 0.5061
Epoch 5/10
39/39 - 0s - loss: 0.3319 - accuracy: 0.8887 - auc_2: 0.6787 - precision_2: 0.6786 - recall_2: 0.0341 - balanced_accuracy: 0.5183 - val_loss: 0.3105 - val_accuracy: 0.8936 - val_auc_2: 0.7290 - val_precision_2: 1.0000 - val_recall_2: 0.0576 - val_balanced_accuracy: 0.5341
Epoch 6/10
39/39 - 0s - loss: 0.3212 - accuracy: 0.8921 - auc_2: 0.7007 - precision_2: 0.7647 - recall_2: 0.0699 - balanced_accuracy: 0.5345 - val_loss: 0.3054 - val_accuracy: 0.8976 - val_auc_2: 0.7387 - val_precision_2: 1.0000 - val_recall_2: 0.0935 - val_balanced_accuracy: 0.5516
Epoch 7/10
39/39 - 0s - loss: 0.3096 - accuracy: 0.8930 - auc_2: 0.7445 - precision_2: 0.7067 - recall_2: 0.0950 - balanced_accuracy: 0.5434 - val_loss: 0.3017 - val_accuracy: 0.8976 - val_auc_2: 0.7459 - val_precision_2: 0.9333 - val_recall_2: 0.1007 - val_balanced_accuracy: 0.5553
Epoch 8/10
39/39 - 0s - loss: 0.3050 - accuracy: 0.8948 - auc_2: 0.7491 - precision_2: 0.8226 - recall_2: 0.0914 - balanced_accuracy: 0.5393 - val_loss: 0.2980 - val_accuracy: 0.8993 - val_auc_2: 0.7531 - val_precision_2: 0.8947 - val_recall_2: 0.1223 - val_balanced_accuracy: 0.5647
Epoch 9/10
39/39 - 0s - loss: 0.3033 - accuracy: 0.8974 - auc_2: 0.7493 - precision_2: 0.7789 - recall_2: 0.1326 - balanced_accuracy: 0.5653 - val_loss: 0.2962 - val_accuracy: 0.8993 - val_auc_2: 0.7568 - val_precision_2: 0.8947 - val_recall_2: 0.1223 - val_balanced_accuracy: 0.5647
Epoch 10/10
39/39 - 0s - loss: 0.2973 - accuracy: 0.8958 - auc_2: 0.7628 - precision_2: 0.7320 - recall_2: 0.1272 - balanced_accuracy: 0.5618 - val_loss: 0.2939 - val_accuracy: 0.9033 - val_auc_2: 0.7610 - val_precision_2: 0.9167 - val_recall_2: 0.1583 - val_balanced_accuracy: 0.5801
Epoch 00010: val_loss improved from inf to 0.29395, saving model to /home/zadubrov/output/results_train/Aromatase_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for Aromatase: 0.11 min









































































Permutation explainer: 1906it [02:39, 11.23it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'Aromatase single-labeled Fold-0' on test data
INFO     Loss: 0.6088
INFO     Accuracy: 0.6921
INFO     AUC: 0.5434
INFO     Precision: 0.1341
INFO     Recall: 0.3165
INFO     Balanced Accuracy: nan
INFO     MCC: 0.0404
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
39/39 [==============================] - 1s 9ms/step - loss: 0.6088 - accuracy: 0.6921 - auc: 0.5434 - precision: 0.1341 - recall: 0.3165 - balanced_accuracy: nan
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO      Your training data is extremely unbalanced (TR): 0 - 4999, and 1 - 373 values.
INFO      I will not down-sample your data automatically.
INFO      Consider to enable down sampling of the 0 values with --sampleDown option.
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5372 valid entries in fp and TR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4999, 1.0: 373}
INFO     X training matrix of shape (5372, 2048) and type bool
INFO     Y training matrix of shape (5372,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.596706122341414
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:25:49.930662: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:25:49.930830: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:25:49.954516: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:25:49.955517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:25:49.956530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:25:49.957544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:25:49.963860: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
Epoch 1/10
34/34 - 2s - loss: 0.2768 - accuracy: 0.9304 - auc_2: 0.5006 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4999 - val_loss: 0.2532 - val_accuracy: 0.9302 - val_auc_2: 0.5577 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
34/34 - 0s - loss: 0.2619 - accuracy: 0.9306 - auc_2: 0.5615 - precision_2: 0.5000 - recall_2: 0.0034 - balanced_accuracy: 0.5020 - val_loss: 0.2498 - val_accuracy: 0.9302 - val_auc_2: 0.5893 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
34/34 - 0s - loss: 0.2618 - accuracy: 0.9302 - auc_2: 0.5708 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4998 - val_loss: 0.2464 - val_accuracy: 0.9302 - val_auc_2: 0.6174 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
34/34 - 0s - loss: 0.2574 - accuracy: 0.9304 - auc_2: 0.5862 - precision_2: 0.3333 - recall_2: 0.0034 - balanced_accuracy: 0.5016 - val_loss: 0.2429 - val_accuracy: 0.9302 - val_auc_2: 0.6448 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
34/34 - 0s - loss: 0.2471 - accuracy: 0.9309 - auc_2: 0.6352 - precision_2: 0.6667 - recall_2: 0.0067 - balanced_accuracy: 0.5023 - val_loss: 0.2413 - val_accuracy: 0.9302 - val_auc_2: 0.6537 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
34/34 - 0s - loss: 0.2440 - accuracy: 0.9309 - auc_2: 0.6556 - precision_2: 0.6667 - recall_2: 0.0067 - balanced_accuracy: 0.5038 - val_loss: 0.2392 - val_accuracy: 0.9302 - val_auc_2: 0.6666 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
34/34 - 0s - loss: 0.2428 - accuracy: 0.9311 - auc_2: 0.6606 - precision_2: 0.7500 - recall_2: 0.0101 - balanced_accuracy: 0.5045 - val_loss: 0.2381 - val_accuracy: 0.9302 - val_auc_2: 0.6757 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 8/10
34/34 - 0s - loss: 0.2374 - accuracy: 0.9311 - auc_2: 0.6795 - precision_2: 0.7500 - recall_2: 0.0101 - balanced_accuracy: 0.5058 - val_loss: 0.2370 - val_accuracy: 0.9302 - val_auc_2: 0.6787 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 9/10
INFO     Computation time for training the single-label model for TR: 0.1 min
34/34 - 0s - loss: 0.2364 - accuracy: 0.9306 - auc_2: 0.6914 - precision_2: 0.5000 - recall_2: 0.0168 - balanced_accuracy: 0.5058 - val_loss: 0.2358 - val_accuracy: 0.9293 - val_auc_2: 0.6853 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.4995
Epoch 10/10
34/34 - 0s - loss: 0.2231 - accuracy: 0.9309 - auc_2: 0.7468 - precision_2: 0.6000 - recall_2: 0.0101 - balanced_accuracy: 0.5038 - val_loss: 0.2350 - val_accuracy: 0.9293 - val_auc_2: 0.6901 - val_precision_2: 0.3333 - val_recall_2: 0.0133 - val_balanced_accuracy: 0.5030
Epoch 00010: val_loss improved from inf to 0.23505, saving model to /home/zadubrov/output/results_train/TR_single-labeled_Fold-0.model.weights.hdf5





































































Permutation explainer: 1776it [02:29, 11.12it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'TR single-labeled Fold-0' on test data
 7/34 [=====>........................] - ETA: 0s - loss: 1.1409 - accuracy: 0.1295 - auc: 0.5908 - precision: 0.0888 - recall: 1.0000 - balanced_accuracy: 0.5243
INFO     Loss: 1.173
INFO     Accuracy: 0.1014
INFO     AUC: 0.4959
INFO     Precision: 0.0704
INFO     Recall: 0.9733
INFO     Balanced Accuracy: nan
INFO     MCC: 0.0129
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5456 valid entries in fp and PPARg
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4880, 1.0: 576}
INFO     X training matrix of shape (5456, 2048) and type bool
INFO     Y training matrix of shape (5456,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.1361027241839663
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.

34/34 [==============================] - 2s 9ms/step - loss: 1.1730 - accuracy: 0.1014 - auc: 0.4959 - precision: 0.0704 - recall: 0.9733 - balanced_accuracy: nan
Epoch 1/10
2023-04-03 14:28:29.317833: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:28:29.318005: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:28:29.335141: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:28:29.336139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:28:29.337209: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:28:29.338146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:28:29.344179: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
35/35 - 2s - loss: 0.3640 - accuracy: 0.8937 - auc_2: 0.5032 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4996 - val_loss: 0.3384 - val_accuracy: 0.8947 - val_auc_2: 0.5521 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
35/35 - 0s - loss: 0.3553 - accuracy: 0.8932 - auc_2: 0.5451 - precision_2: 0.2222 - recall_2: 0.0043 - balanced_accuracy: nan - val_loss: 0.3281 - val_accuracy: 0.8947 - val_auc_2: 0.6289 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
35/35 - 0s - loss: 0.3434 - accuracy: 0.8923 - auc_2: 0.5900 - precision_2: 0.0909 - recall_2: 0.0022 - balanced_accuracy: nan - val_loss: 0.3228 - val_accuracy: 0.8947 - val_auc_2: 0.6621 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
35/35 - 0s - loss: 0.3376 - accuracy: 0.8937 - auc_2: 0.6110 - precision_2: 0.2000 - recall_2: 0.0022 - balanced_accuracy: 0.5006 - val_loss: 0.3176 - val_accuracy: 0.8947 - val_auc_2: 0.6922 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
35/35 - 0s - loss: 0.3315 - accuracy: 0.8939 - auc_2: 0.6286 - precision_2: 0.4167 - recall_2: 0.0108 - balanced_accuracy: 0.5038 - val_loss: 0.3127 - val_accuracy: 0.8947 - val_auc_2: 0.7112 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
35/35 - 0s - loss: 0.3253 - accuracy: 0.8939 - auc_2: 0.6556 - precision_2: 0.4286 - recall_2: 0.0130 - balanced_accuracy: 0.5055 - val_loss: 0.3098 - val_accuracy: 0.8947 - val_auc_2: 0.7207 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
35/35 - 0s - loss: 0.3197 - accuracy: 0.8937 - auc_2: 0.6720 - precision_2: 0.3636 - recall_2: 0.0087 - balanced_accuracy: 0.5041 - val_loss: 0.3071 - val_accuracy: 0.8947 - val_auc_2: 0.7305 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 8/10
35/35 - 0s - loss: 0.3087 - accuracy: 0.8962 - auc_2: 0.7061 - precision_2: 0.7500 - recall_2: 0.0260 - balanced_accuracy: nan - val_loss: 0.3044 - val_accuracy: 0.8956 - val_auc_2: 0.7365 - val_precision_2: 1.0000 - val_recall_2: 0.0087 - val_balanced_accuracy: 0.5035
Epoch 9/10
35/35 - 0s - loss: 0.3082 - accuracy: 0.8953 - auc_2: 0.7111 - precision_2: 0.5909 - recall_2: 0.0282 - balanced_accuracy: 0.5134 - val_loss: 0.3023 - val_accuracy: 0.8947 - val_auc_2: 0.7432 - val_precision_2: 0.5000 - val_recall_2: 0.0087 - val_balanced_accuracy: 0.5030
Epoch 10/10
INFO     Computation time for training the single-label model for PPARg: 0.1 min
35/35 - 0s - loss: 0.3081 - accuracy: 0.8953 - auc_2: 0.7141 - precision_2: 0.5769 - recall_2: 0.0325 - balanced_accuracy: 0.5153 - val_loss: 0.3001 - val_accuracy: 0.8956 - val_auc_2: 0.7476 - val_precision_2: 0.6667 - val_recall_2: 0.0174 - val_balanced_accuracy: 0.5099
Epoch 00010: val_loss improved from inf to 0.30010, saving model to /home/zadubrov/output/results_train/PPARg_single-labeled_Fold-0.model.weights.hdf5




































































Permutation explainer: 1756it [02:29, 10.93it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'PPARg single-labeled Fold-0' on test data
35/35 [==============================] - 1s 6ms/step - loss: 0.3984 - accuracy: 0.8864 - auc: 0.5524 - precision: 0.0909 - recall: 0.0087 - balanced_accuracy: nan
INFO     Loss: 0.3984
INFO     Accuracy: 0.8864
INFO     AUC: 0.5524
INFO     Precision: 0.0909
INFO     Recall: 0.0087
INFO     Balanced Accuracy: nan
INFO     MCC: -0.0047
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 7248 valid entries in fp and ED
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0: 5032, 1: 2216}
INFO     X training matrix of shape (7248, 2048) and type bool
INFO     Y training matrix of shape (7248,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -0.8198518837784559
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-03 14:31:08.524235: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-03 14:31:08.524494: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-03 14:31:08.541617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-03 14:31:08.542592: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-03 14:31:08.543588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-03 14:31:08.544514: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-03 14:31:08.551953: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
46/46 - 2s - loss: 0.6626 - accuracy: 0.6425 - auc_2: 0.5306 - precision_2: 0.3447 - recall_2: 0.1878 - balanced_accuracy: 0.5155 - val_loss: 0.5890 - val_accuracy: 0.6966 - val_auc_2: 0.6452 - val_precision_2: 0.5263 - val_recall_2: 0.0677 - val_balanced_accuracy: 0.5141
Epoch 2/10
46/46 - 0s - loss: 0.6300 - accuracy: 0.6675 - auc_2: 0.5882 - precision_2: 0.4213 - recall_2: 0.2341 - balanced_accuracy: 0.5491 - val_loss: 0.5643 - val_accuracy: 0.7124 - val_auc_2: 0.7032 - val_precision_2: 0.6275 - val_recall_2: 0.1445 - val_balanced_accuracy: 0.5478
Epoch 3/10
46/46 - 0s - loss: 0.6092 - accuracy: 0.6813 - auc_2: 0.6215 - precision_2: 0.4626 - recall_2: 0.2617 - balanced_accuracy: 0.5632 - val_loss: 0.5493 - val_accuracy: 0.7221 - val_auc_2: 0.7268 - val_precision_2: 0.6754 - val_recall_2: 0.1738 - val_balanced_accuracy: 0.5611
Epoch 4/10
46/46 - 1s - loss: 0.5920 - accuracy: 0.7002 - auc_2: 0.6483 - precision_2: 0.5176 - recall_2: 0.2910 - balanced_accuracy: 0.5840 - val_loss: 0.5364 - val_accuracy: 0.7428 - val_auc_2: 0.7443 - val_precision_2: 0.7273 - val_recall_2: 0.2528 - val_balanced_accuracy: 0.5960
Epoch 5/10
46/46 - 0s - loss: 0.5807 - accuracy: 0.7056 - auc_2: 0.6678 - precision_2: 0.5356 - recall_2: 0.2798 - balanced_accuracy: 0.5865 - val_loss: 0.5271 - val_accuracy: 0.7552 - val_auc_2: 0.7561 - val_precision_2: 0.7222 - val_recall_2: 0.3228 - val_balanced_accuracy: 0.6238
Epoch 6/10
46/46 - 0s - loss: 0.5701 - accuracy: 0.7156 - auc_2: 0.6844 - precision_2: 0.5611 - recall_2: 0.3209 - balanced_accuracy: 0.6085 - val_loss: 0.5198 - val_accuracy: 0.7586 - val_auc_2: 0.7637 - val_precision_2: 0.7085 - val_recall_2: 0.3567 - val_balanced_accuracy: 0.6365
Epoch 7/10
46/46 - 0s - loss: 0.5594 - accuracy: 0.7232 - auc_2: 0.7033 - precision_2: 0.5769 - recall_2: 0.3553 - balanced_accuracy: 0.6196 - val_loss: 0.5137 - val_accuracy: 0.7628 - val_auc_2: 0.7677 - val_precision_2: 0.7391 - val_recall_2: 0.3454 - val_balanced_accuracy: 0.6352
Epoch 8/10
46/46 - 0s - loss: 0.5465 - accuracy: 0.7347 - auc_2: 0.7203 - precision_2: 0.6118 - recall_2: 0.3627 - balanced_accuracy: 0.6303 - val_loss: 0.5087 - val_accuracy: 0.7634 - val_auc_2: 0.7723 - val_precision_2: 0.7155 - val_recall_2: 0.3747 - val_balanced_accuracy: 0.6437
Epoch 9/10
46/46 - 0s - loss: 0.5429 - accuracy: 0.7318 - auc_2: 0.7249 - precision_2: 0.6064 - recall_2: 0.3503 - balanced_accuracy: 0.6253 - val_loss: 0.5047 - val_accuracy: 0.7634 - val_auc_2: 0.7750 - val_precision_2: 0.7066 - val_recall_2: 0.3860 - val_balanced_accuracy: 0.6480
Epoch 10/10
46/46 - 1s - loss: 0.5346 - accuracy: 0.7411 - auc_2: 0.7376 - precision_2: 0.6241 - recall_2: 0.3858 - balanced_accuracy: 0.6426 - val_loss: 0.5008 - val_accuracy: 0.7655 - val_auc_2: 0.7794 - val_precision_2: 0.6859 - val_recall_2: 0.4289 - val_balanced_accuracy: 0.6633
Epoch 00010: val_loss improved from inf to 0.50078, saving model to /home/zadubrov/output/results_train/ED_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for ED: 0.12 min














































































Permutation explainer: 1976it [02:47, 11.05it/s]
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'ED single-labeled Fold-0' on test data
46/46 [==============================] - 1s 9ms/step - loss: 0.7348 - accuracy: 0.4579 - auc: 0.4457 - precision: 0.2716 - recall: 0.4605 - balanced_accuracy: 0.4675
INFO     Loss: 0.7348
INFO     Accuracy: 0.4579
INFO     AUC: 0.4457
INFO     Precision: 0.2716
INFO     Recall: 0.4605
INFO     Balanced Accuracy: 0.4675
INFO     MCC: -0.0762
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets