WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
Epoch 1/10
2023-04-04 10:05:50.869836: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-04 10:05:50.870205: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-04 10:05:50.888498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-04 10:05:50.889476: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-04 10:05:50.890503: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-04 10:05:50.891499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-04 10:05:50.918700: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.033ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
2023-04-04 10:05:51.186453: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-04-04 10:05:57.829127: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 8s - loss: 0.5045 - accuracy: 0.8074 - auc: 0.5153 - precision: 0.2018 - recall: 0.0260 - balanced_accuracy: 0.5019 - val_loss: 0.4495 - val_accuracy: 0.8226 - val_auc: 0.6250 - val_precision: 1.0000 - val_recall: 0.0094 - val_balanced_accuracy: 0.5050
Epoch 2/10
37/37 - 0s - loss: 0.4766 - accuracy: 0.8196 - auc: 0.5818 - precision: 0.4615 - recall: 0.0496 - balanced_accuracy: 0.5182 - val_loss: 0.4292 - val_accuracy: 0.8319 - val_auc: 0.6881 - val_precision: 0.9333 - val_recall: 0.0660 - val_balanced_accuracy: 0.5354
Epoch 3/10
37/37 - 0s - loss: 0.4588 - accuracy: 0.8224 - auc: 0.6278 - precision: 0.5221 - recall: 0.0838 - balanced_accuracy: 0.5314 - val_loss: 0.4148 - val_accuracy: 0.8446 - val_auc: 0.7265 - val_precision: 0.9375 - val_recall: 0.1415 - val_balanced_accuracy: 0.5732
Epoch 4/10
37/37 - 0s - loss: 0.4440 - accuracy: 0.8315 - auc: 0.6606 - precision: 0.6503 - recall: 0.1251 - balanced_accuracy: 0.5565 - val_loss: 0.4033 - val_accuracy: 0.8480 - val_auc: 0.7504 - val_precision: 0.9000 - val_recall: 0.1698 - val_balanced_accuracy: 0.5837
Epoch 5/10
37/37 - 0s - loss: 0.4363 - accuracy: 0.8321 - auc: 0.6761 - precision: 0.6444 - recall: 0.1370 - balanced_accuracy: 0.5613 - val_loss: 0.3942 - val_accuracy: 0.8488 - val_auc: 0.7650 - val_precision: 0.9024 - val_recall: 0.1745 - val_balanced_accuracy: 0.5861
Epoch 6/10
37/37 - 0s - loss: 0.4220 - accuracy: 0.8382 - auc: 0.7073 - precision: 0.6938 - recall: 0.1712 - balanced_accuracy: 0.5771 - val_loss: 0.3865 - val_accuracy: 0.8488 - val_auc: 0.7794 - val_precision: 0.9024 - val_recall: 0.1745 - val_balanced_accuracy: 0.5861
Epoch 7/10
37/37 - 0s - loss: 0.4215 - accuracy: 0.8372 - auc: 0.7055 - precision: 0.6900 - recall: 0.1629 - balanced_accuracy: 0.5719 - val_loss: 0.3795 - val_accuracy: 0.8505 - val_auc: 0.7912 - val_precision: 0.8571 - val_recall: 0.1981 - val_balanced_accuracy: 0.6027
Epoch 8/10
37/37 - 0s - loss: 0.4099 - accuracy: 0.8363 - auc: 0.7328 - precision: 0.6552 - recall: 0.1795 - balanced_accuracy: 0.5796 - val_loss: 0.3738 - val_accuracy: 0.8505 - val_auc: 0.7973 - val_precision: 0.8571 - val_recall: 0.1981 - val_balanced_accuracy: 0.6027
Epoch 9/10
37/37 - 0s - loss: 0.3977 - accuracy: 0.8408 - auc: 0.7533 - precision: 0.7048 - recall: 0.1889 - balanced_accuracy: 0.5846 - val_loss: 0.3686 - val_accuracy: 0.8505 - val_auc: 0.8032 - val_precision: 0.8571 - val_recall: 0.1981 - val_balanced_accuracy: 0.6027
Epoch 10/10
37/37 - 0s - loss: 0.3855 - accuracy: 0.8511 - auc: 0.7688 - precision: 0.7773 - recall: 0.2349 - balanced_accuracy: 0.6100 - val_loss: 0.3637 - val_accuracy: 0.8539 - val_auc: 0.8098 - val_precision: 0.8305 - val_recall: 0.2311 - val_balanced_accuracy: 0.6169
Epoch 00010: val_loss improved from inf to 0.36371, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for AR: 0.22 min
<IPython.core.display.HTML object>
'tuple' object has no attribute 'shape'
usage: deepFPlearn [-h] {traingnn,predictgnn,train,predict,convert} ...