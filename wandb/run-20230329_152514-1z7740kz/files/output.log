WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
Epoch 1/10
2023-03-29 15:25:36.508018: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:25:36.508278: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:25:36.530591: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:25:36.531556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:25:36.532878: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:25:36.533872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:25:36.563164: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.032ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
2023-03-29 15:25:36.860590: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
37/37 - 5s - loss: 0.4985 - accuracy: 0.8004 - auc: 0.5513 - precision: 0.1859 - recall: 0.0342 - balanced_accuracy: 0.5011 - val_loss: 0.4517 - val_accuracy: 0.8209 - val_auc: 0.6258 - val_precision: 0.0000e+00 - val_recall: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
2023-03-29 15:25:40.432265: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 0s - loss: 0.4795 - accuracy: 0.8144 - auc: 0.5805 - precision: 0.3545 - recall: 0.0460 - balanced_accuracy: 0.5136 - val_loss: 0.4327 - val_accuracy: 0.8260 - val_auc: 0.6800 - val_precision: 0.8750 - val_recall: 0.0330 - val_balanced_accuracy: 0.5157
Epoch 3/10
37/37 - 0s - loss: 0.4612 - accuracy: 0.8192 - auc: 0.6290 - precision: 0.4667 - recall: 0.0744 - balanced_accuracy: 0.5276 - val_loss: 0.4188 - val_accuracy: 0.8404 - val_auc: 0.7076 - val_precision: 0.9600 - val_recall: 0.1132 - val_balanced_accuracy: 0.5528
Epoch 4/10
37/37 - 0s - loss: 0.4426 - accuracy: 0.8281 - auc: 0.6648 - precision: 0.6107 - recall: 0.1074 - balanced_accuracy: 0.5452 - val_loss: 0.4094 - val_accuracy: 0.8429 - val_auc: 0.7211 - val_precision: 0.9062 - val_recall: 0.1368 - val_balanced_accuracy: 0.5635
Epoch 5/10
37/37 - 0s - loss: 0.4325 - accuracy: 0.8253 - auc: 0.6902 - precision: 0.5549 - recall: 0.1192 - balanced_accuracy: 0.5497 - val_loss: 0.4020 - val_accuracy: 0.8454 - val_auc: 0.7324 - val_precision: 0.8718 - val_recall: 0.1604 - val_balanced_accuracy: 0.5734
Epoch 6/10
37/37 - 0s - loss: 0.4220 - accuracy: 0.8408 - auc: 0.7014 - precision: 0.7163 - recall: 0.1818 - balanced_accuracy: 0.5824 - val_loss: 0.3959 - val_accuracy: 0.8497 - val_auc: 0.7432 - val_precision: 0.8542 - val_recall: 0.1934 - val_balanced_accuracy: 0.5851
Epoch 7/10
37/37 - 0s - loss: 0.4143 - accuracy: 0.8395 - auc: 0.7208 - precision: 0.6900 - recall: 0.1865 - balanced_accuracy: 0.5855 - val_loss: 0.3904 - val_accuracy: 0.8522 - val_auc: 0.7530 - val_precision: 0.8136 - val_recall: 0.2264 - val_balanced_accuracy: 0.5989
Epoch 8/10
37/37 - 0s - loss: 0.4064 - accuracy: 0.8460 - auc: 0.7336 - precision: 0.7521 - recall: 0.2078 - balanced_accuracy: 0.5967 - val_loss: 0.3861 - val_accuracy: 0.8539 - val_auc: 0.7583 - val_precision: 0.8095 - val_recall: 0.2406 - val_balanced_accuracy: 0.6044
Epoch 9/10
37/37 - 0s - loss: 0.4020 - accuracy: 0.8450 - auc: 0.7421 - precision: 0.7216 - recall: 0.2172 - balanced_accuracy: 0.6007 - val_loss: 0.3822 - val_accuracy: 0.8530 - val_auc: 0.7644 - val_precision: 0.7969 - val_recall: 0.2406 - val_balanced_accuracy: 0.6039
Epoch 10/10
37/37 - 0s - loss: 0.3923 - accuracy: 0.8490 - auc: 0.7568 - precision: 0.7444 - recall: 0.2373 - balanced_accuracy: 0.6101 - val_loss: 0.3783 - val_accuracy: 0.8497 - val_auc: 0.7709 - val_precision: 0.7500 - val_recall: 0.2406 - val_balanced_accuracy: 0.6020
Epoch 00010: val_loss improved from inf to 0.37828, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
31/37 [========================>.....] - ETA: 0s - loss: 0.5220 - accuracy: 0.8165 - auc: 0.5220 - precision: 0.4375 - recall: 0.0389 - balanced_accuracy: 0.5109
INFO     Computation time for training the single-label model for AR: 0.16 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________

37/37 [==============================] - 1s 10ms/step - loss: 0.5210 - accuracy: 0.8167 - auc: 0.5147 - precision: 0.3810 - recall: 0.0377 - balanced_accuracy: 0.5090
INFO     Loss: 0.521
INFO     Accuracy: 0.8167
INFO     AUC: 0.5147
INFO     Precision: 0.381
INFO     Recall: 0.0377
INFO     Balanced Accuracy: 0.509
INFO     MCC: 0.0708
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
2023-03-29 15:25:48.639985: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5590 valid entries in fp and ER
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4252, 1.0: 1338}
INFO     X training matrix of shape (5590, 2048) and type bool
INFO     Y training matrix of shape (5590,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -1.1567048454998552
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:25:49.875495: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:25:49.875706: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:25:49.894832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:25:49.895800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:25:49.896892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:25:49.898067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:25:49.905559: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
35/35 - 2s - loss: 0.5902 - accuracy: 0.7330 - auc_2: 0.5190 - precision_2: 0.2862 - recall_2: 0.0776 - balanced_accuracy: 0.5088 - val_loss: 0.5392 - val_accuracy: 0.7603 - val_auc_2: 0.5958 - val_precision_2: 0.5000 - val_recall_2: 0.0187 - val_balanced_accuracy: 0.5055
Epoch 2/10
35/35 - 0s - loss: 0.5634 - accuracy: 0.7408 - auc_2: 0.5794 - precision_2: 0.3541 - recall_2: 0.1009 - balanced_accuracy: 0.5220 - val_loss: 0.5188 - val_accuracy: 0.7674 - val_auc_2: 0.6632 - val_precision_2: 0.7000 - val_recall_2: 0.0522 - val_balanced_accuracy: 0.5201
Epoch 3/10
35/35 - 0s - loss: 0.5474 - accuracy: 0.7493 - auc_2: 0.6152 - precision_2: 0.4274 - recall_2: 0.1402 - balanced_accuracy: 0.5407 - val_loss: 0.5043 - val_accuracy: 0.7737 - val_auc_2: 0.6961 - val_precision_2: 0.7778 - val_recall_2: 0.0784 - val_balanced_accuracy: 0.5334
Epoch 4/10
35/35 - 0s - loss: 0.5263 - accuracy: 0.7654 - auc_2: 0.6530 - precision_2: 0.5291 - recall_2: 0.1785 - balanced_accuracy: 0.5645 - val_loss: 0.4929 - val_accuracy: 0.7809 - val_auc_2: 0.7177 - val_precision_2: 0.7447 - val_recall_2: 0.1306 - val_balanced_accuracy: 0.5570
Epoch 5/10
35/35 - 0s - loss: 0.5192 - accuracy: 0.7706 - auc_2: 0.6687 - precision_2: 0.5615 - recall_2: 0.1879 - balanced_accuracy: 0.5711 - val_loss: 0.4837 - val_accuracy: 0.7871 - val_auc_2: 0.7330 - val_precision_2: 0.7273 - val_recall_2: 0.1791 - val_balanced_accuracy: 0.5792
Epoch 6/10
35/35 - 0s - loss: 0.4994 - accuracy: 0.7757 - auc_2: 0.7037 - precision_2: 0.5884 - recall_2: 0.2084 - balanced_accuracy: 0.5824 - val_loss: 0.4764 - val_accuracy: 0.7898 - val_auc_2: 0.7427 - val_precision_2: 0.7037 - val_recall_2: 0.2127 - val_balanced_accuracy: 0.5937
Epoch 7/10
35/35 - 0s - loss: 0.4914 - accuracy: 0.7768 - auc_2: 0.7171 - precision_2: 0.5849 - recall_2: 0.2318 - balanced_accuracy: 0.5903 - val_loss: 0.4696 - val_accuracy: 0.7907 - val_auc_2: 0.7524 - val_precision_2: 0.6932 - val_recall_2: 0.2276 - val_balanced_accuracy: 0.5995
Epoch 8/10
35/35 - 0s - loss: 0.4819 - accuracy: 0.7858 - auc_2: 0.7303 - precision_2: 0.6308 - recall_2: 0.2523 - balanced_accuracy: 0.6006 - val_loss: 0.4641 - val_accuracy: 0.7943 - val_auc_2: 0.7589 - val_precision_2: 0.6900 - val_recall_2: 0.2575 - val_balanced_accuracy: 0.6117
Epoch 9/10
35/35 - 0s - loss: 0.4661 - accuracy: 0.7934 - auc_2: 0.7610 - precision_2: 0.6622 - recall_2: 0.2785 - balanced_accuracy: 0.6177 - val_loss: 0.4588 - val_accuracy: 0.7961 - val_auc_2: 0.7656 - val_precision_2: 0.6695 - val_recall_2: 0.2948 - val_balanced_accuracy: 0.6242
Epoch 10/10
35/35 - 0s - loss: 0.4681 - accuracy: 0.7961 - auc_2: 0.7520 - precision_2: 0.6717 - recall_2: 0.2888 - balanced_accuracy: 0.6210 - val_loss: 0.4543 - val_accuracy: 0.7996 - val_auc_2: 0.7708 - val_precision_2: 0.6719 - val_recall_2: 0.3209 - val_balanced_accuracy: 0.6356
Epoch 00010: val_loss improved from inf to 0.45432, saving model to /home/zadubrov/output/results_train/ER_single-labeled_Fold-0.model.weights.hdf5
 7/35 [=====>........................] - ETA: 0s - loss: 0.8410 - accuracy: 0.3214 - auc: 0.5378 - precision: 0.2186 - recall: 0.8163 - balanced_accuracy: 0.4747
INFO     Computation time for training the single-label model for ER: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________

35/35 [==============================] - 1s 7ms/step - loss: 0.8244 - accuracy: 0.3390 - auc: 0.5498 - precision: 0.2470 - recall: 0.8582 - balanced_accuracy: 0.5129
INFO     Loss: 0.8244
INFO     Accuracy: 0.339
INFO     AUC: 0.5498
INFO     Precision: 0.247
INFO     Recall: 0.8582
INFO     Balanced Accuracy: 0.5129
INFO     MCC: 0.0383
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6055 valid entries in fp and GR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5454, 1.0: 601}
INFO     X training matrix of shape (6055, 2048) and type bool
INFO     Y training matrix of shape (6055,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.2050479030178485
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:26:00.302318: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:26:00.302479: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:26:00.320348: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:26:00.321321: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:26:00.322508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:26:00.323734: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:26:00.329935: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.012ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
38/38 - 2s - loss: 0.3422 - accuracy: 0.8986 - auc_2: 0.5384 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4989 - val_loss: 0.3014 - val_accuracy: 0.9009 - val_auc_2: 0.6703 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
38/38 - 0s - loss: 0.3199 - accuracy: 0.9013 - auc_2: 0.6125 - precision_2: 0.6154 - recall_2: 0.0166 - balanced_accuracy: 0.5075 - val_loss: 0.2843 - val_accuracy: 0.9059 - val_auc_2: 0.7155 - val_precision_2: 1.0000 - val_recall_2: 0.0500 - val_balanced_accuracy: 0.5320
Epoch 3/10
38/38 - 0s - loss: 0.3056 - accuracy: 0.9055 - auc_2: 0.6608 - precision_2: 0.8966 - recall_2: 0.0541 - balanced_accuracy: 0.5274 - val_loss: 0.2740 - val_accuracy: 0.9149 - val_auc_2: 0.7383 - val_precision_2: 0.9474 - val_recall_2: 0.1500 - val_balanced_accuracy: 0.5825
Epoch 4/10
38/38 - 0s - loss: 0.2934 - accuracy: 0.9100 - auc_2: 0.6856 - precision_2: 0.9412 - recall_2: 0.0998 - balanced_accuracy: 0.5497 - val_loss: 0.2665 - val_accuracy: 0.9166 - val_auc_2: 0.7524 - val_precision_2: 0.9524 - val_recall_2: 0.1667 - val_balanced_accuracy: 0.5897
Epoch 5/10
38/38 - 0s - loss: 0.2807 - accuracy: 0.9147 - auc_2: 0.7253 - precision_2: 0.9359 - recall_2: 0.1518 - balanced_accuracy: 0.5798 - val_loss: 0.2614 - val_accuracy: 0.9191 - val_auc_2: 0.7617 - val_precision_2: 0.9583 - val_recall_2: 0.1917 - val_balanced_accuracy: 0.6020
Epoch 6/10
38/38 - 0s - loss: 0.2775 - accuracy: 0.9162 - auc_2: 0.7277 - precision_2: 0.9121 - recall_2: 0.1726 - balanced_accuracy: 0.5826 - val_loss: 0.2577 - val_accuracy: 0.9224 - val_auc_2: 0.7718 - val_precision_2: 0.9333 - val_recall_2: 0.2333 - val_balanced_accuracy: 0.6218
Epoch 7/10
38/38 - 0s - loss: 0.2665 - accuracy: 0.9187 - auc_2: 0.7546 - precision_2: 0.8783 - recall_2: 0.2100 - balanced_accuracy: 0.6043 - val_loss: 0.2547 - val_accuracy: 0.9224 - val_auc_2: 0.7786 - val_precision_2: 0.9062 - val_recall_2: 0.2417 - val_balanced_accuracy: 0.6264
Epoch 8/10
38/38 - 0s - loss: 0.2632 - accuracy: 0.9193 - auc_2: 0.7626 - precision_2: 0.9091 - recall_2: 0.2079 - balanced_accuracy: 0.6009 - val_loss: 0.2525 - val_accuracy: 0.9216 - val_auc_2: 0.7847 - val_precision_2: 0.8571 - val_recall_2: 0.2500 - val_balanced_accuracy: 0.6297
Epoch 9/10
38/38 - 0s - loss: 0.2592 - accuracy: 0.9199 - auc_2: 0.7705 - precision_2: 0.8780 - recall_2: 0.2245 - balanced_accuracy: 0.6087 - val_loss: 0.2504 - val_accuracy: 0.9207 - val_auc_2: 0.7896 - val_precision_2: 0.8158 - val_recall_2: 0.2583 - val_balanced_accuracy: 0.6338
Epoch 10/10
38/38 - 0s - loss: 0.2493 - accuracy: 0.9232 - auc_2: 0.7970 - precision_2: 0.9225 - recall_2: 0.2474 - balanced_accuracy: 0.6238 - val_loss: 0.2487 - val_accuracy: 0.9207 - val_auc_2: 0.7902 - val_precision_2: 0.8158 - val_recall_2: 0.2583 - val_balanced_accuracy: 0.6338
Epoch 00010: val_loss improved from inf to 0.24875, saving model to /home/zadubrov/output/results_train/GR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for GR: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'GR single-labeled Fold-0' on test data
38/38 [==============================] - 1s 9ms/step - loss: 1.2854 - accuracy: 0.1082 - auc: 0.5952 - precision: 0.1000 - recall: 1.0000 - balanced_accuracy: 0.5052
INFO     Loss: 1.2854
INFO     Accuracy: 0.1082
INFO     AUC: 0.5952
INFO     Precision: 0.1
INFO     Recall: 1.0
INFO     Balanced Accuracy: 0.5052
INFO     MCC: 0.0318
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6154 valid entries in fp and Aromatase
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5457, 1.0: 697}
INFO     X training matrix of shape (6154, 2048) and type bool
INFO     Y training matrix of shape (6154,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.0570145058923917
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:26:10.547705: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:26:10.547932: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:26:10.567891: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:26:10.569108: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:26:10.570515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:26:10.571771: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:26:10.579880: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.017ms.
  function_optimizer: function_optimizer did nothing. time = 0.003ms.
39/39 - 2s - loss: 0.3893 - accuracy: 0.8775 - auc_2: 0.5295 - precision_2: 0.0909 - recall_2: 0.0090 - balanced_accuracy: 0.4992 - val_loss: 0.3436 - val_accuracy: 0.8871 - val_auc_2: 0.5994 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
39/39 - 0s - loss: 0.3614 - accuracy: 0.8834 - auc_2: 0.5969 - precision_2: 0.2647 - recall_2: 0.0161 - balanced_accuracy: 0.5046 - val_loss: 0.3319 - val_accuracy: 0.8879 - val_auc_2: 0.6538 - val_precision_2: 1.0000 - val_recall_2: 0.0072 - val_balanced_accuracy: 0.5026
Epoch 3/10
39/39 - 0s - loss: 0.3515 - accuracy: 0.8854 - auc_2: 0.6225 - precision_2: 0.4444 - recall_2: 0.0430 - balanced_accuracy: 0.5195 - val_loss: 0.3238 - val_accuracy: 0.8911 - val_auc_2: 0.6802 - val_precision_2: 1.0000 - val_recall_2: 0.0360 - val_balanced_accuracy: 0.5168
Epoch 4/10
39/39 - 0s - loss: 0.3353 - accuracy: 0.8889 - auc_2: 0.6686 - precision_2: 0.5932 - recall_2: 0.0627 - balanced_accuracy: 0.5254 - val_loss: 0.3174 - val_accuracy: 0.8960 - val_auc_2: 0.6996 - val_precision_2: 1.0000 - val_recall_2: 0.0791 - val_balanced_accuracy: 0.5405
Epoch 5/10
39/39 - 0s - loss: 0.3221 - accuracy: 0.8956 - auc_2: 0.7010 - precision_2: 0.7683 - recall_2: 0.1129 - balanced_accuracy: 0.5553 - val_loss: 0.3136 - val_accuracy: 0.8968 - val_auc_2: 0.7092 - val_precision_2: 0.9286 - val_recall_2: 0.0935 - val_balanced_accuracy: 0.5487
Epoch 6/10
39/39 - 0s - loss: 0.3176 - accuracy: 0.8948 - auc_2: 0.7077 - precision_2: 0.7273 - recall_2: 0.1147 - balanced_accuracy: 0.5557 - val_loss: 0.3108 - val_accuracy: 0.8976 - val_auc_2: 0.7199 - val_precision_2: 0.8824 - val_recall_2: 0.1079 - val_balanced_accuracy: 0.5542
Epoch 7/10
39/39 - 0s - loss: 0.3153 - accuracy: 0.8950 - auc_2: 0.7154 - precision_2: 0.7595 - recall_2: 0.1075 - balanced_accuracy: 0.5506 - val_loss: 0.3093 - val_accuracy: 0.8993 - val_auc_2: 0.7256 - val_precision_2: 0.8947 - val_recall_2: 0.1223 - val_balanced_accuracy: 0.5608
Epoch 8/10
39/39 - 0s - loss: 0.3053 - accuracy: 0.8958 - auc_2: 0.7474 - precision_2: 0.7064 - recall_2: 0.1380 - balanced_accuracy: 0.5648 - val_loss: 0.3068 - val_accuracy: 0.8976 - val_auc_2: 0.7326 - val_precision_2: 0.8095 - val_recall_2: 0.1223 - val_balanced_accuracy: 0.5600
Epoch 9/10
39/39 - 1s - loss: 0.3038 - accuracy: 0.8978 - auc_2: 0.7471 - precision_2: 0.7477 - recall_2: 0.1487 - balanced_accuracy: 0.5738 - val_loss: 0.3068 - val_accuracy: 0.8976 - val_auc_2: 0.7353 - val_precision_2: 0.7826 - val_recall_2: 0.1295 - val_balanced_accuracy: 0.5623
Epoch 10/10
39/39 - 0s - loss: 0.2941 - accuracy: 0.8984 - auc_2: 0.7655 - precision_2: 0.7302 - recall_2: 0.1649 - balanced_accuracy: 0.5777 - val_loss: 0.3049 - val_accuracy: 0.8976 - val_auc_2: 0.7394 - val_precision_2: 0.7600 - val_recall_2: 0.1367 - val_balanced_accuracy: 0.5645
Epoch 00010: val_loss improved from inf to 0.30488, saving model to /home/zadubrov/output/results_train/Aromatase_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for Aromatase: 0.12 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'Aromatase single-labeled Fold-0' on test data
39/39 [==============================] - 2s 9ms/step - loss: 1.2628 - accuracy: 0.1202 - auc: 0.4693 - precision: 0.1131 - recall: 0.9928 - balanced_accuracy: nan
INFO     Loss: 1.2628
INFO     Accuracy: 0.1202
INFO     AUC: 0.4693
INFO     Precision: 0.1131
INFO     Recall: 0.9928
INFO     Balanced Accuracy: nan
INFO     MCC: 0.0066
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO      Your training data is extremely unbalanced (TR): 0 - 4999, and 1 - 373 values.
INFO      I will not down-sample your data automatically.
INFO      Consider to enable down sampling of the 0 values with --sampleDown option.
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5372 valid entries in fp and TR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4999, 1.0: 373}
INFO     X training matrix of shape (5372, 2048) and type bool
INFO     Y training matrix of shape (5372,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.596706122341414
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:26:22.020343: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:26:22.020564: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:26:22.042407: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:26:22.043422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:26:22.044634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:26:22.045674: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:26:22.051919: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.01ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
34/34 - 2s - loss: 0.2751 - accuracy: 0.9300 - auc_2: 0.5131 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4996 - val_loss: 0.2537 - val_accuracy: 0.9302 - val_auc_2: 0.5574 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
34/34 - 0s - loss: 0.2674 - accuracy: 0.9302 - auc_2: 0.5338 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4997 - val_loss: 0.2493 - val_accuracy: 0.9302 - val_auc_2: 0.6021 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
34/34 - 0s - loss: 0.2548 - accuracy: 0.9300 - auc_2: 0.6034 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4996 - val_loss: 0.2454 - val_accuracy: 0.9302 - val_auc_2: 0.6373 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
34/34 - 0s - loss: 0.2522 - accuracy: 0.9304 - auc_2: 0.6064 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4999 - val_loss: 0.2418 - val_accuracy: 0.9302 - val_auc_2: 0.6656 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
34/34 - 0s - loss: 0.2455 - accuracy: 0.9306 - auc_2: 0.6537 - precision_2: 0.5000 - recall_2: 0.0067 - balanced_accuracy: 0.5023 - val_loss: 0.2379 - val_accuracy: 0.9302 - val_auc_2: 0.6903 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
34/34 - 0s - loss: 0.2387 - accuracy: 0.9304 - auc_2: 0.6787 - precision_2: 0.4000 - recall_2: 0.0067 - balanced_accuracy: 0.5024 - val_loss: 0.2364 - val_accuracy: 0.9302 - val_auc_2: 0.6969 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
34/34 - 0s - loss: 0.2362 - accuracy: 0.9316 - auc_2: 0.6893 - precision_2: 0.8333 - recall_2: 0.0168 - balanced_accuracy: 0.5065 - val_loss: 0.2349 - val_accuracy: 0.9312 - val_auc_2: 0.7051 - val_precision_2: 1.0000 - val_recall_2: 0.0133 - val_balanced_accuracy: 0.5062
Epoch 8/10
34/34 - 0s - loss: 0.2395 - accuracy: 0.9306 - auc_2: 0.6756 - precision_2: 0.5000 - recall_2: 0.0101 - balanced_accuracy: 0.5040 - val_loss: 0.2339 - val_accuracy: 0.9312 - val_auc_2: 0.7110 - val_precision_2: 1.0000 - val_recall_2: 0.0133 - val_balanced_accuracy: 0.5062
Epoch 9/10
34/34 - 0s - loss: 0.2278 - accuracy: 0.9313 - auc_2: 0.7220 - precision_2: 0.7143 - recall_2: 0.0168 - balanced_accuracy: 0.5088 - val_loss: 0.2328 - val_accuracy: 0.9321 - val_auc_2: 0.7161 - val_precision_2: 1.0000 - val_recall_2: 0.0267 - val_balanced_accuracy: 0.5112
Epoch 10/10
34/34 - 0s - loss: 0.2247 - accuracy: 0.9311 - auc_2: 0.7351 - precision_2: 0.6000 - recall_2: 0.0201 - balanced_accuracy: 0.5090 - val_loss: 0.2314 - val_accuracy: 0.9312 - val_auc_2: 0.7240 - val_precision_2: 0.6000 - val_recall_2: 0.0400 - val_balanced_accuracy: 0.5165
Epoch 00010: val_loss improved from inf to 0.23137, saving model to /home/zadubrov/output/results_train/TR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for TR: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'TR single-labeled Fold-0' on test data
34/34 [==============================] - 1s 9ms/step - loss: 1.0870 - accuracy: 0.1209 - auc: 0.5175 - precision: 0.0702 - recall: 0.9467 - balanced_accuracy: nan
INFO     Loss: 1.087
INFO     Accuracy: 0.1209
INFO     AUC: 0.5175
INFO     Precision: 0.0702
INFO     Recall: 0.9467
INFO     Balanced Accuracy: nan
INFO     MCC: 0.0061
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5456 valid entries in fp and PPARg
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4880, 1.0: 576}
INFO     X training matrix of shape (5456, 2048) and type bool
INFO     Y training matrix of shape (5456,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.1361027241839663
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:26:31.896838: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:26:31.897120: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:26:31.939307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:26:31.940663: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:26:31.945360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:26:31.948622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:26:31.962656: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
35/35 - 2s - loss: 0.3592 - accuracy: 0.8934 - auc_2: 0.5129 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: nan - val_loss: 0.3358 - val_accuracy: 0.8947 - val_auc_2: 0.5636 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
35/35 - 0s - loss: 0.3512 - accuracy: 0.8923 - auc_2: 0.5553 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4989 - val_loss: 0.3283 - val_accuracy: 0.8947 - val_auc_2: 0.6210 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
35/35 - 0s - loss: 0.3415 - accuracy: 0.8928 - auc_2: 0.5933 - precision_2: 0.1818 - recall_2: 0.0043 - balanced_accuracy: 0.5008 - val_loss: 0.3224 - val_accuracy: 0.8947 - val_auc_2: 0.6583 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
35/35 - 0s - loss: 0.3326 - accuracy: 0.8948 - auc_2: 0.6164 - precision_2: 0.6000 - recall_2: 0.0130 - balanced_accuracy: 0.5052 - val_loss: 0.3175 - val_accuracy: 0.8947 - val_auc_2: 0.6840 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
35/35 - 0s - loss: 0.3288 - accuracy: 0.8941 - auc_2: 0.6393 - precision_2: 0.4444 - recall_2: 0.0087 - balanced_accuracy: 0.5039 - val_loss: 0.3136 - val_accuracy: 0.8947 - val_auc_2: 0.7013 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
35/35 - 0s - loss: 0.3220 - accuracy: 0.8937 - auc_2: 0.6698 - precision_2: 0.4118 - recall_2: 0.0152 - balanced_accuracy: nan - val_loss: 0.3103 - val_accuracy: 0.8947 - val_auc_2: 0.7154 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
35/35 - 0s - loss: 0.3146 - accuracy: 0.8941 - auc_2: 0.6928 - precision_2: 0.4615 - recall_2: 0.0130 - balanced_accuracy: 0.5056 - val_loss: 0.3074 - val_accuracy: 0.8947 - val_auc_2: 0.7252 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 8/10
35/35 - 0s - loss: 0.3127 - accuracy: 0.8939 - auc_2: 0.6953 - precision_2: 0.4444 - recall_2: 0.0174 - balanced_accuracy: 0.5059 - val_loss: 0.3048 - val_accuracy: 0.8947 - val_auc_2: 0.7312 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 9/10
35/35 - 0s - loss: 0.3071 - accuracy: 0.8939 - auc_2: 0.7167 - precision_2: 0.4286 - recall_2: 0.0130 - balanced_accuracy: nan - val_loss: 0.3025 - val_accuracy: 0.8956 - val_auc_2: 0.7385 - val_precision_2: 1.0000 - val_recall_2: 0.0087 - val_balanced_accuracy: 0.5056
Epoch 10/10
35/35 - 0s - loss: 0.3023 - accuracy: 0.8960 - auc_2: 0.7294 - precision_2: 0.6522 - recall_2: 0.0325 - balanced_accuracy: 0.5158 - val_loss: 0.3007 - val_accuracy: 0.8947 - val_auc_2: 0.7414 - val_precision_2: 0.5000 - val_recall_2: 0.0087 - val_balanced_accuracy: 0.5051
Epoch 00010: val_loss improved from inf to 0.30074, saving model to /home/zadubrov/output/results_train/PPARg_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for PPARg: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'PPARg single-labeled Fold-0' on test data
35/35 [==============================] - 2s 7ms/step - loss: 0.6605 - accuracy: 0.5989 - auc: 0.5087 - precision: 0.1127 - recall: 0.4087 - balanced_accuracy: 0.5145
INFO     Loss: 0.6605
INFO     Accuracy: 0.5989
INFO     AUC: 0.5087
INFO     Precision: 0.1127
INFO     Recall: 0.4087
INFO     Balanced Accuracy: 0.5145
INFO     MCC: 0.0189
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 7248 valid entries in fp and ED
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0: 5032, 1: 2216}
INFO     X training matrix of shape (7248, 2048) and type bool
INFO     Y training matrix of shape (7248,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -0.8198518837784559
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:26:42.545885: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:26:42.546114: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:26:42.566171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:26:42.567147: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:26:42.568310: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:26:42.569405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:26:42.577913: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.01ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
46/46 - 2s - loss: 0.6405 - accuracy: 0.6628 - auc_2: 0.5618 - precision_2: 0.3896 - recall_2: 0.1810 - balanced_accuracy: 0.5290 - val_loss: 0.5875 - val_accuracy: 0.7000 - val_auc_2: 0.6593 - val_precision_2: 0.5328 - val_recall_2: 0.1467 - val_balanced_accuracy: 0.5554
Epoch 2/10
46/46 - 1s - loss: 0.6212 - accuracy: 0.6754 - auc_2: 0.6014 - precision_2: 0.4418 - recall_2: 0.2335 - balanced_accuracy: 0.5513 - val_loss: 0.5703 - val_accuracy: 0.7186 - val_auc_2: 0.6925 - val_precision_2: 0.6115 - val_recall_2: 0.2167 - val_balanced_accuracy: 0.5866
Epoch 3/10
46/46 - 1s - loss: 0.5922 - accuracy: 0.6994 - auc_2: 0.6507 - precision_2: 0.5161 - recall_2: 0.2719 - balanced_accuracy: 0.5816 - val_loss: 0.5582 - val_accuracy: 0.7221 - val_auc_2: 0.7094 - val_precision_2: 0.6136 - val_recall_2: 0.2438 - val_balanced_accuracy: 0.5962
Epoch 4/10
46/46 - 1s - loss: 0.5888 - accuracy: 0.7051 - auc_2: 0.6548 - precision_2: 0.5330 - recall_2: 0.2871 - balanced_accuracy: 0.5882 - val_loss: 0.5487 - val_accuracy: 0.7234 - val_auc_2: 0.7234 - val_precision_2: 0.6094 - val_recall_2: 0.2641 - val_balanced_accuracy: 0.6006
Epoch 5/10
46/46 - 1s - loss: 0.5718 - accuracy: 0.7092 - auc_2: 0.6822 - precision_2: 0.5448 - recall_2: 0.2984 - balanced_accuracy: 0.5957 - val_loss: 0.5417 - val_accuracy: 0.7310 - val_auc_2: 0.7341 - val_precision_2: 0.6100 - val_recall_2: 0.3318 - val_balanced_accuracy: 0.6260
Epoch 6/10
46/46 - 1s - loss: 0.5643 - accuracy: 0.7144 - auc_2: 0.6956 - precision_2: 0.5579 - recall_2: 0.3181 - balanced_accuracy: 0.6033 - val_loss: 0.5354 - val_accuracy: 0.7345 - val_auc_2: 0.7403 - val_precision_2: 0.6142 - val_recall_2: 0.3521 - val_balanced_accuracy: 0.6355
Epoch 7/10
46/46 - 1s - loss: 0.5529 - accuracy: 0.7246 - auc_2: 0.7095 - precision_2: 0.5876 - recall_2: 0.3328 - balanced_accuracy: 0.6159 - val_loss: 0.5298 - val_accuracy: 0.7352 - val_auc_2: 0.7465 - val_precision_2: 0.6105 - val_recall_2: 0.3679 - val_balanced_accuracy: 0.6408
Epoch 8/10
46/46 - 1s - loss: 0.5471 - accuracy: 0.7306 - auc_2: 0.7183 - precision_2: 0.6027 - recall_2: 0.3491 - balanced_accuracy: 0.6243 - val_loss: 0.5253 - val_accuracy: 0.7469 - val_auc_2: 0.7525 - val_precision_2: 0.6284 - val_recall_2: 0.4199 - val_balanced_accuracy: 0.6626
Epoch 9/10
46/46 - 1s - loss: 0.5294 - accuracy: 0.7420 - auc_2: 0.7438 - precision_2: 0.6281 - recall_2: 0.3830 - balanced_accuracy: 0.6392 - val_loss: 0.5222 - val_accuracy: 0.7476 - val_auc_2: 0.7571 - val_precision_2: 0.6238 - val_recall_2: 0.4379 - val_balanced_accuracy: 0.6702
Epoch 10/10
46/46 - 1s - loss: 0.5247 - accuracy: 0.7370 - auc_2: 0.7508 - precision_2: 0.6148 - recall_2: 0.3745 - balanced_accuracy: 0.6356 - val_loss: 0.5185 - val_accuracy: 0.7490 - val_auc_2: 0.7615 - val_precision_2: 0.6262 - val_recall_2: 0.4424 - val_balanced_accuracy: 0.6727
Epoch 00010: val_loss improved from inf to 0.51848, saving model to /home/zadubrov/output/results_train/ED_single-labeled_Fold-0.model.weights.hdf5
19/46 [===========>..................] - ETA: 0s - loss: 1.0330 - accuracy: 0.2878 - auc: 0.4829 - precision: 0.2838 - recall: 0.9770 - balanced_accuracy: 0.4920
INFO     Computation time for training the single-label model for ED: 0.13 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________

46/46 [==============================] - 1s 9ms/step - loss: 1.0131 - accuracy: 0.3097 - auc: 0.4882 - precision: 0.3046 - recall: 0.9819 - balanced_accuracy: 0.4969
INFO     Loss: 1.0131
INFO     Accuracy: 0.3097
INFO     AUC: 0.4882
INFO     Precision: 0.3046
INFO     Recall: 0.9819
INFO     Balanced Accuracy: 0.4969
INFO     MCC: -0.0157
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets