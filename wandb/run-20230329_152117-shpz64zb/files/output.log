WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
Epoch 1/10
2023-03-29 15:21:40.394872: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:21:40.395163: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:21:40.417714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:21:40.421055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:21:40.424016: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:21:40.426832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:21:40.461077: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.037ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
2023-03-29 15:21:40.786699: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-03-29 15:21:47.081682: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 7s - loss: 0.4942 - accuracy: 0.8070 - auc: 0.5488 - precision: 0.2481 - recall: 0.0390 - balanced_accuracy: 0.5074 - val_loss: 0.4530 - val_accuracy: 0.8277 - val_auc: 0.6052 - val_precision: 1.0000 - val_recall: 0.0377 - val_balanced_accuracy: 0.5187
Epoch 2/10
37/37 - 0s - loss: 0.4704 - accuracy: 0.8213 - auc: 0.5920 - precision: 0.5043 - recall: 0.0685 - balanced_accuracy: 0.5261 - val_loss: 0.4377 - val_accuracy: 0.8336 - val_auc: 0.6511 - val_precision: 1.0000 - val_recall: 0.0708 - val_balanced_accuracy: 0.5344
Epoch 3/10
37/37 - 0s - loss: 0.4494 - accuracy: 0.8256 - auc: 0.6505 - precision: 0.5802 - recall: 0.0897 - balanced_accuracy: 0.5387 - val_loss: 0.4273 - val_accuracy: 0.8378 - val_auc: 0.6835 - val_precision: 0.8571 - val_recall: 0.1132 - val_balanced_accuracy: 0.5508
Epoch 4/10
37/37 - 0s - loss: 0.4405 - accuracy: 0.8372 - auc: 0.6606 - precision: 0.7235 - recall: 0.1452 - balanced_accuracy: 0.5659 - val_loss: 0.4195 - val_accuracy: 0.8378 - val_auc: 0.7027 - val_precision: 0.8125 - val_recall: 0.1226 - val_balanced_accuracy: 0.5541
Epoch 5/10
37/37 - 0s - loss: 0.4289 - accuracy: 0.8351 - auc: 0.6905 - precision: 0.6737 - recall: 0.1511 - balanced_accuracy: 0.5666 - val_loss: 0.4135 - val_accuracy: 0.8387 - val_auc: 0.7180 - val_precision: 0.8000 - val_recall: 0.1321 - val_balanced_accuracy: 0.5586
Epoch 6/10
37/37 - 0s - loss: 0.4219 - accuracy: 0.8380 - auc: 0.7053 - precision: 0.6835 - recall: 0.1759 - balanced_accuracy: 0.5792 - val_loss: 0.4080 - val_accuracy: 0.8387 - val_auc: 0.7289 - val_precision: 0.7692 - val_recall: 0.1415 - val_balanced_accuracy: 0.5627
Epoch 7/10
37/37 - 0s - loss: 0.4035 - accuracy: 0.8441 - auc: 0.7379 - precision: 0.7466 - recall: 0.1948 - balanced_accuracy: 0.5914 - val_loss: 0.4035 - val_accuracy: 0.8395 - val_auc: 0.7376 - val_precision: 0.7750 - val_recall: 0.1462 - val_balanced_accuracy: 0.5644
Epoch 8/10
37/37 - 0s - loss: 0.3937 - accuracy: 0.8490 - auc: 0.7581 - precision: 0.7481 - recall: 0.2349 - balanced_accuracy: 0.6128 - val_loss: 0.3996 - val_accuracy: 0.8404 - val_auc: 0.7454 - val_precision: 0.7347 - val_recall: 0.1698 - val_balanced_accuracy: 0.5768
Epoch 9/10
37/37 - 0s - loss: 0.3999 - accuracy: 0.8482 - auc: 0.7423 - precision: 0.7443 - recall: 0.2302 - balanced_accuracy: 0.6062 - val_loss: 0.3954 - val_accuracy: 0.8446 - val_auc: 0.7530 - val_precision: 0.7500 - val_recall: 0.1981 - val_balanced_accuracy: 0.5900
Epoch 10/10
37/37 - 0s - loss: 0.3880 - accuracy: 0.8492 - auc: 0.7626 - precision: 0.7285 - recall: 0.2503 - balanced_accuracy: 0.6167 - val_loss: 0.3918 - val_accuracy: 0.8454 - val_auc: 0.7600 - val_precision: 0.7458 - val_recall: 0.2075 - val_balanced_accuracy: 0.5944
Epoch 00010: val_loss improved from inf to 0.39179, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
 1/37 [..............................] - ETA: 26s - loss: 0.4061 - accuracy: 0.9062 - auc: 0.3161 - precision: 0.0000e+00 - recall: 0.0000e+00 - balanced_accuracy: 0.5000
INFO     Computation time for training the single-label model for AR: 0.21 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________

37/37 [==============================] - 1s 9ms/step - loss: 0.4934 - accuracy: 0.8201 - auc: 0.5095 - precision: 0.0000e+00 - recall: 0.0000e+00 - balanced_accuracy: 0.4995
INFO     Loss: 0.4934
INFO     Accuracy: 0.8201
INFO     AUC: 0.5095
INFO     Precision: 0.0
INFO     Recall: 0.0
INFO     Balanced Accuracy: 0.4995
INFO     MCC: -0.0136
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
2023-03-29 15:21:55.512186: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/AR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5590 valid entries in fp and ER
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4252, 1.0: 1338}
INFO     X training matrix of shape (5590, 2048) and type bool
INFO     Y training matrix of shape (5590,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -1.1567048454998552
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:21:56.731449: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:21:56.731760: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:21:56.769145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:21:56.770198: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:21:56.771585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:21:56.772718: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:21:56.789879: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
35/35 - 2s - loss: 0.5950 - accuracy: 0.7422 - auc_2: 0.5042 - precision_2: 0.2872 - recall_2: 0.0523 - balanced_accuracy: 0.5059 - val_loss: 0.5404 - val_accuracy: 0.7621 - val_auc_2: 0.5896 - val_precision_2: 0.5714 - val_recall_2: 0.0299 - val_balanced_accuracy: 0.5113
Epoch 2/10
35/35 - 0s - loss: 0.5612 - accuracy: 0.7395 - auc_2: 0.5798 - precision_2: 0.3453 - recall_2: 0.0991 - balanced_accuracy: 0.5205 - val_loss: 0.5200 - val_accuracy: 0.7710 - val_auc_2: 0.6535 - val_precision_2: 0.7143 - val_recall_2: 0.0746 - val_balanced_accuracy: 0.5317
Epoch 3/10
35/35 - 0s - loss: 0.5397 - accuracy: 0.7518 - auc_2: 0.6296 - precision_2: 0.4320 - recall_2: 0.1187 - balanced_accuracy: 0.5351 - val_loss: 0.5038 - val_accuracy: 0.7818 - val_auc_2: 0.6917 - val_precision_2: 0.7727 - val_recall_2: 0.1269 - val_balanced_accuracy: 0.5561
Epoch 4/10
35/35 - 0s - loss: 0.5245 - accuracy: 0.7610 - auc_2: 0.6560 - precision_2: 0.5016 - recall_2: 0.1458 - balanced_accuracy: 0.5507 - val_loss: 0.4925 - val_accuracy: 0.7880 - val_auc_2: 0.7133 - val_precision_2: 0.7818 - val_recall_2: 0.1604 - val_balanced_accuracy: 0.5734
Epoch 5/10
35/35 - 0s - loss: 0.5082 - accuracy: 0.7750 - auc_2: 0.6860 - precision_2: 0.5838 - recall_2: 0.2084 - balanced_accuracy: 0.5800 - val_loss: 0.4824 - val_accuracy: 0.7907 - val_auc_2: 0.7301 - val_precision_2: 0.7361 - val_recall_2: 0.1978 - val_balanced_accuracy: 0.5891
Epoch 6/10
35/35 - 0s - loss: 0.5048 - accuracy: 0.7726 - auc_2: 0.6938 - precision_2: 0.5685 - recall_2: 0.2056 - balanced_accuracy: 0.5819 - val_loss: 0.4753 - val_accuracy: 0.7925 - val_auc_2: 0.7385 - val_precision_2: 0.7250 - val_recall_2: 0.2164 - val_balanced_accuracy: 0.5958
Epoch 7/10
35/35 - 0s - loss: 0.4906 - accuracy: 0.7773 - auc_2: 0.7214 - precision_2: 0.5811 - recall_2: 0.2477 - balanced_accuracy: 0.5970 - val_loss: 0.4684 - val_accuracy: 0.7952 - val_auc_2: 0.7482 - val_precision_2: 0.7053 - val_recall_2: 0.2500 - val_balanced_accuracy: 0.6069
Epoch 8/10
35/35 - 0s - loss: 0.4790 - accuracy: 0.7880 - auc_2: 0.7376 - precision_2: 0.6399 - recall_2: 0.2607 - balanced_accuracy: 0.6073 - val_loss: 0.4627 - val_accuracy: 0.7952 - val_auc_2: 0.7556 - val_precision_2: 0.6893 - val_recall_2: 0.2649 - val_balanced_accuracy: 0.6110
Epoch 9/10
35/35 - 0s - loss: 0.4768 - accuracy: 0.7862 - auc_2: 0.7417 - precision_2: 0.6332 - recall_2: 0.2533 - balanced_accuracy: 0.6037 - val_loss: 0.4577 - val_accuracy: 0.8014 - val_auc_2: 0.7616 - val_precision_2: 0.7054 - val_recall_2: 0.2948 - val_balanced_accuracy: 0.6251
Epoch 10/10
35/35 - 0s - loss: 0.4613 - accuracy: 0.7956 - auc_2: 0.7650 - precision_2: 0.6632 - recall_2: 0.2963 - balanced_accuracy: 0.6247 - val_loss: 0.4527 - val_accuracy: 0.8041 - val_auc_2: 0.7682 - val_precision_2: 0.7025 - val_recall_2: 0.3172 - val_balanced_accuracy: 0.6373
Epoch 00010: val_loss improved from inf to 0.45273, saving model to /home/zadubrov/output/results_train/ER_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for ER: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'ER single-labeled Fold-0' on test data
35/35 [==============================] - 1s 9ms/step - loss: 0.5822 - accuracy: 0.7370 - auc: 0.5611 - precision: 0.3415 - recall: 0.1045 - balanced_accuracy: 0.5236
INFO     Loss: 0.5822
INFO     Accuracy: 0.737
INFO     AUC: 0.5611
INFO     Precision: 0.3415
INFO     Recall: 0.1045
INFO     Balanced Accuracy: 0.5236
INFO     MCC: 0.0671
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ER_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6055 valid entries in fp and GR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5454, 1.0: 601}
INFO     X training matrix of shape (6055, 2048) and type bool
INFO     Y training matrix of shape (6055,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.2050479030178485
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:22:07.454044: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:22:07.454224: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:22:07.474373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:22:07.475340: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:22:07.476468: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:22:07.477653: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:22:07.487802: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
38/38 - 2s - loss: 0.3390 - accuracy: 0.8976 - auc_2: 0.5641 - precision_2: 0.1053 - recall_2: 0.0042 - balanced_accuracy: 0.5008 - val_loss: 0.3033 - val_accuracy: 0.9009 - val_auc_2: 0.6833 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
38/38 - 0s - loss: 0.3187 - accuracy: 0.9013 - auc_2: 0.6297 - precision_2: 0.6000 - recall_2: 0.0187 - balanced_accuracy: 0.5076 - val_loss: 0.2827 - val_accuracy: 0.9026 - val_auc_2: 0.7362 - val_precision_2: 1.0000 - val_recall_2: 0.0167 - val_balanced_accuracy: 0.5071
Epoch 3/10
38/38 - 0s - loss: 0.2999 - accuracy: 0.9034 - auc_2: 0.6818 - precision_2: 0.7097 - recall_2: 0.0457 - balanced_accuracy: 0.5228 - val_loss: 0.2700 - val_accuracy: 0.9116 - val_auc_2: 0.7601 - val_precision_2: 1.0000 - val_recall_2: 0.1083 - val_balanced_accuracy: 0.5463
Epoch 4/10
38/38 - 0s - loss: 0.2874 - accuracy: 0.9081 - auc_2: 0.7151 - precision_2: 0.7727 - recall_2: 0.1060 - balanced_accuracy: 0.5521 - val_loss: 0.2599 - val_accuracy: 0.9174 - val_auc_2: 0.7793 - val_precision_2: 1.0000 - val_recall_2: 0.1667 - val_balanced_accuracy: 0.5724
Epoch 5/10
38/38 - 0s - loss: 0.2799 - accuracy: 0.9143 - auc_2: 0.7242 - precision_2: 0.8511 - recall_2: 0.1663 - balanced_accuracy: 0.5849 - val_loss: 0.2535 - val_accuracy: 0.9216 - val_auc_2: 0.7883 - val_precision_2: 1.0000 - val_recall_2: 0.2083 - val_balanced_accuracy: 0.5903
Epoch 6/10
38/38 - 0s - loss: 0.2720 - accuracy: 0.9176 - auc_2: 0.7445 - precision_2: 0.9020 - recall_2: 0.1913 - balanced_accuracy: 0.5953 - val_loss: 0.2491 - val_accuracy: 0.9216 - val_auc_2: 0.7950 - val_precision_2: 0.9630 - val_recall_2: 0.2167 - val_balanced_accuracy: 0.5930
Epoch 7/10
38/38 - 0s - loss: 0.2659 - accuracy: 0.9178 - auc_2: 0.7531 - precision_2: 0.8739 - recall_2: 0.2017 - balanced_accuracy: 0.6005 - val_loss: 0.2459 - val_accuracy: 0.9216 - val_auc_2: 0.8029 - val_precision_2: 0.9310 - val_recall_2: 0.2250 - val_balanced_accuracy: 0.5962
Epoch 8/10
38/38 - 0s - loss: 0.2612 - accuracy: 0.9174 - auc_2: 0.7719 - precision_2: 0.8403 - recall_2: 0.2079 - balanced_accuracy: 0.6024 - val_loss: 0.2422 - val_accuracy: 0.9207 - val_auc_2: 0.8090 - val_precision_2: 0.9000 - val_recall_2: 0.2250 - val_balanced_accuracy: 0.5957
Epoch 9/10
38/38 - 0s - loss: 0.2534 - accuracy: 0.9205 - auc_2: 0.7859 - precision_2: 0.8810 - recall_2: 0.2308 - balanced_accuracy: 0.6095 - val_loss: 0.2390 - val_accuracy: 0.9224 - val_auc_2: 0.8158 - val_precision_2: 0.9062 - val_recall_2: 0.2417 - val_balanced_accuracy: 0.6024
Epoch 10/10
38/38 - 0s - loss: 0.2520 - accuracy: 0.9209 - auc_2: 0.7846 - precision_2: 0.8603 - recall_2: 0.2432 - balanced_accuracy: 0.6202 - val_loss: 0.2372 - val_accuracy: 0.9224 - val_auc_2: 0.8189 - val_precision_2: 0.9062 - val_recall_2: 0.2417 - val_balanced_accuracy: 0.6024
Epoch 00010: val_loss improved from inf to 0.23721, saving model to /home/zadubrov/output/results_train/GR_single-labeled_Fold-0.model.weights.hdf5
32/38 [========================>.....] - ETA: 0s - loss: 1.3111 - accuracy: 0.1055 - auc: 0.6517 - precision: 0.1046 - recall: 1.0000 - balanced_accuracy: 0.5006
INFO     Computation time for training the single-label model for GR: 0.12 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'GR single-labeled Fold-0' on test data
INFO     Loss: 1.3195
INFO     Accuracy: 0.1007
INFO     AUC: 0.6266
INFO     Precision: 0.0993
INFO     Recall: 1.0
INFO     Balanced Accuracy: 0.5009

38/38 [==============================] - 1s 9ms/step - loss: 1.3195 - accuracy: 0.1007 - auc: 0.6266 - precision: 0.0993 - recall: 1.0000 - balanced_accuracy: 0.5009
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/GR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 6154 valid entries in fp and Aromatase
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 5457, 1.0: 697}
INFO     X training matrix of shape (6154, 2048) and type bool
INFO     Y training matrix of shape (6154,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.0570145058923917
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:22:18.057258: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:22:18.057483: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:22:18.075631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:22:18.076609: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:22:18.077688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:22:18.078978: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:22:18.085779: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
Epoch 1/10
39/39 - 2s - loss: 0.3787 - accuracy: 0.8840 - auc_2: 0.5204 - precision_2: 0.1176 - recall_2: 0.0036 - balanced_accuracy: 0.4999 - val_loss: 0.3457 - val_accuracy: 0.8871 - val_auc_2: 0.5991 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
39/39 - 0s - loss: 0.3612 - accuracy: 0.8844 - auc_2: 0.5842 - precision_2: 0.1333 - recall_2: 0.0036 - balanced_accuracy: 0.5006 - val_loss: 0.3329 - val_accuracy: 0.8871 - val_auc_2: 0.6633 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
39/39 - 0s - loss: 0.3495 - accuracy: 0.8862 - auc_2: 0.6150 - precision_2: 0.4444 - recall_2: 0.0143 - balanced_accuracy: 0.5062 - val_loss: 0.3225 - val_accuracy: 0.8895 - val_auc_2: 0.6968 - val_precision_2: 1.0000 - val_recall_2: 0.0216 - val_balanced_accuracy: 0.5125
Epoch 4/10
39/39 - 0s - loss: 0.3322 - accuracy: 0.8869 - auc_2: 0.6817 - precision_2: 0.5152 - recall_2: 0.0305 - balanced_accuracy: 0.5141 - val_loss: 0.3161 - val_accuracy: 0.8936 - val_auc_2: 0.7101 - val_precision_2: 1.0000 - val_recall_2: 0.0576 - val_balanced_accuracy: 0.5307
Epoch 5/10
39/39 - 0s - loss: 0.3268 - accuracy: 0.8889 - auc_2: 0.6870 - precision_2: 0.6279 - recall_2: 0.0484 - balanced_accuracy: 0.5214 - val_loss: 0.3106 - val_accuracy: 0.8968 - val_auc_2: 0.7232 - val_precision_2: 1.0000 - val_recall_2: 0.0863 - val_balanced_accuracy: 0.5434
Epoch 6/10
39/39 - 0s - loss: 0.3260 - accuracy: 0.8930 - auc_2: 0.6864 - precision_2: 0.7719 - recall_2: 0.0789 - balanced_accuracy: 0.5377 - val_loss: 0.3062 - val_accuracy: 0.8968 - val_auc_2: 0.7343 - val_precision_2: 0.8750 - val_recall_2: 0.1007 - val_balanced_accuracy: 0.5500
Epoch 7/10
39/39 - 0s - loss: 0.3174 - accuracy: 0.8938 - auc_2: 0.7140 - precision_2: 0.7465 - recall_2: 0.0950 - balanced_accuracy: 0.5454 - val_loss: 0.3025 - val_accuracy: 0.8976 - val_auc_2: 0.7424 - val_precision_2: 0.8824 - val_recall_2: 0.1079 - val_balanced_accuracy: 0.5539
Epoch 8/10
39/39 - 0s - loss: 0.3115 - accuracy: 0.8954 - auc_2: 0.7302 - precision_2: 0.7529 - recall_2: 0.1147 - balanced_accuracy: 0.5551 - val_loss: 0.2994 - val_accuracy: 0.8968 - val_auc_2: 0.7531 - val_precision_2: 0.8333 - val_recall_2: 0.1079 - val_balanced_accuracy: 0.5532
Epoch 9/10
39/39 - 0s - loss: 0.3049 - accuracy: 0.8988 - auc_2: 0.7393 - precision_2: 0.8261 - recall_2: 0.1362 - balanced_accuracy: 0.5647 - val_loss: 0.2968 - val_accuracy: 0.8968 - val_auc_2: 0.7582 - val_precision_2: 0.7727 - val_recall_2: 0.1223 - val_balanced_accuracy: 0.5578
Epoch 10/10
39/39 - 0s - loss: 0.3030 - accuracy: 0.8952 - auc_2: 0.7525 - precision_2: 0.7692 - recall_2: 0.1075 - balanced_accuracy: 0.5516 - val_loss: 0.2940 - val_accuracy: 0.8960 - val_auc_2: 0.7666 - val_precision_2: 0.6897 - val_recall_2: 0.1439 - val_balanced_accuracy: 0.5680
Epoch 00010: val_loss improved from inf to 0.29398, saving model to /home/zadubrov/output/results_train/Aromatase_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for Aromatase: 0.12 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'Aromatase single-labeled Fold-0' on test data
39/39 [==============================] - 1s 9ms/step - loss: 0.5973 - accuracy: 0.7206 - auc: 0.4561 - precision: 0.0884 - recall: 0.1583 - balanced_accuracy: nan
INFO     Loss: 0.5973
INFO     Accuracy: 0.7206
INFO     AUC: 0.4561
INFO     Precision: 0.0884
INFO     Recall: 0.1583
INFO     Balanced Accuracy: nan
INFO     MCC: -0.0391
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/Aromatase_saved_model/assets
INFO      Your training data is extremely unbalanced (TR): 0 - 4999, and 1 - 373 values.
INFO      I will not down-sample your data automatically.
INFO      Consider to enable down sampling of the 0 values with --sampleDown option.
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5372 valid entries in fp and TR
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4999, 1.0: 373}
INFO     X training matrix of shape (5372, 2048) and type bool
INFO     Y training matrix of shape (5372,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.596706122341414
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:22:29.151625: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:22:29.151809: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:22:29.169950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:22:29.170932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:22:29.172054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:22:29.173153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:22:29.184809: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.001ms.
34/34 - 2s - loss: 0.2722 - accuracy: 0.9304 - auc_2: 0.4895 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4999 - val_loss: 0.2612 - val_accuracy: 0.9302 - val_auc_2: 0.4535 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
34/34 - 0s - loss: 0.2662 - accuracy: 0.9306 - auc_2: 0.5166 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.5000 - val_loss: 0.2573 - val_accuracy: 0.9302 - val_auc_2: 0.5172 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
34/34 - 0s - loss: 0.2581 - accuracy: 0.9304 - auc_2: 0.5645 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.4999 - val_loss: 0.2545 - val_accuracy: 0.9302 - val_auc_2: 0.5561 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
34/34 - 0s - loss: 0.2482 - accuracy: 0.9306 - auc_2: 0.6286 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.5000 - val_loss: 0.2508 - val_accuracy: 0.9302 - val_auc_2: 0.5993 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
34/34 - 0s - loss: 0.2450 - accuracy: 0.9306 - auc_2: 0.6425 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.5000 - val_loss: 0.2489 - val_accuracy: 0.9302 - val_auc_2: 0.6232 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
34/34 - 0s - loss: 0.2402 - accuracy: 0.9306 - auc_2: 0.6647 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.5000 - val_loss: 0.2468 - val_accuracy: 0.9302 - val_auc_2: 0.6384 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
34/34 - 0s - loss: 0.2349 - accuracy: 0.9306 - auc_2: 0.6979 - precision_2: 0.0000e+00 - recall_2: 0.0000e+00 - balanced_accuracy: 0.5000 - val_loss: 0.2462 - val_accuracy: 0.9302 - val_auc_2: 0.6461 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 8/10
34/34 - 0s - loss: 0.2258 - accuracy: 0.9306 - auc_2: 0.7377 - precision_2: 0.5000 - recall_2: 0.0034 - balanced_accuracy: 0.5015 - val_loss: 0.2443 - val_accuracy: 0.9302 - val_auc_2: 0.6582 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 9/10
34/34 - 0s - loss: 0.2242 - accuracy: 0.9306 - auc_2: 0.7568 - precision_2: 0.5000 - recall_2: 0.0067 - balanced_accuracy: 0.5035 - val_loss: 0.2438 - val_accuracy: 0.9302 - val_auc_2: 0.6615 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 10/10
34/34 - 0s - loss: 0.2245 - accuracy: 0.9311 - auc_2: 0.7453 - precision_2: 1.0000 - recall_2: 0.0067 - balanced_accuracy: 0.5031 - val_loss: 0.2422 - val_accuracy: 0.9312 - val_auc_2: 0.6716 - val_precision_2: 1.0000 - val_recall_2: 0.0133 - val_balanced_accuracy: 0.5046
Epoch 00010: val_loss improved from inf to 0.24224, saving model to /home/zadubrov/output/results_train/TR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for TR: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'TR single-labeled Fold-0' on test data
34/34 [==============================] - 1s 9ms/step - loss: 1.2219 - accuracy: 0.0716 - auc: 0.4535 - precision: 0.0691 - recall: 0.9867 - balanced_accuracy: nan
INFO     Loss: 1.2219
INFO     Accuracy: 0.0716
INFO     AUC: 0.4535
INFO     Precision: 0.0691
INFO     Recall: 0.9867
INFO     Balanced Accuracy: nan
INFO     MCC: -0.0432
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
Epoch 1/10
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/TR_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 5456 valid entries in fp and PPARg
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0.0: 4880, 1.0: 576}
INFO     X training matrix of shape (5456, 2048) and type bool
INFO     Y training matrix of shape (5456,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -2.1361027241839663
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:22:39.289019: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:22:39.289318: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:22:39.310643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:22:39.311620: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:22:39.312696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:22:39.313723: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:22:39.326433: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.011ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
35/35 - 2s - loss: 0.3684 - accuracy: 0.8889 - auc_2: 0.5140 - precision_2: 0.1250 - recall_2: 0.0087 - balanced_accuracy: 0.5009 - val_loss: 0.3406 - val_accuracy: 0.8947 - val_auc_2: 0.5341 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 2/10
35/35 - 0s - loss: 0.3630 - accuracy: 0.8923 - auc_2: 0.5297 - precision_2: 0.2000 - recall_2: 0.0065 - balanced_accuracy: 0.5011 - val_loss: 0.3321 - val_accuracy: 0.8947 - val_auc_2: 0.5892 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 3/10
35/35 - 0s - loss: 0.3499 - accuracy: 0.8914 - auc_2: 0.5696 - precision_2: 0.0667 - recall_2: 0.0022 - balanced_accuracy: 0.4990 - val_loss: 0.3250 - val_accuracy: 0.8947 - val_auc_2: 0.6361 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 4/10
35/35 - 0s - loss: 0.3440 - accuracy: 0.8918 - auc_2: 0.5918 - precision_2: 0.2381 - recall_2: 0.0108 - balanced_accuracy: 0.5033 - val_loss: 0.3192 - val_accuracy: 0.8947 - val_auc_2: 0.6691 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 5/10
35/35 - 0s - loss: 0.3330 - accuracy: 0.8923 - auc_2: 0.6336 - precision_2: 0.2353 - recall_2: 0.0087 - balanced_accuracy: 0.5009 - val_loss: 0.3138 - val_accuracy: 0.8947 - val_auc_2: 0.6975 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 6/10
35/35 - 0s - loss: 0.3312 - accuracy: 0.8928 - auc_2: 0.6325 - precision_2: 0.3333 - recall_2: 0.0152 - balanced_accuracy: nan - val_loss: 0.3097 - val_accuracy: 0.8947 - val_auc_2: 0.7149 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 7/10
35/35 - 0s - loss: 0.3242 - accuracy: 0.8918 - auc_2: 0.6592 - precision_2: 0.1765 - recall_2: 0.0065 - balanced_accuracy: 0.5019 - val_loss: 0.3054 - val_accuracy: 0.8947 - val_auc_2: 0.7366 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 8/10
35/35 - 0s - loss: 0.3212 - accuracy: 0.8948 - auc_2: 0.6643 - precision_2: 0.5556 - recall_2: 0.0217 - balanced_accuracy: nan - val_loss: 0.3017 - val_accuracy: 0.8947 - val_auc_2: 0.7519 - val_precision_2: 0.0000e+00 - val_recall_2: 0.0000e+00 - val_balanced_accuracy: 0.5000
Epoch 9/10
35/35 - 0s - loss: 0.3196 - accuracy: 0.8946 - auc_2: 0.6726 - precision_2: 0.5333 - recall_2: 0.0174 - balanced_accuracy: 0.5072 - val_loss: 0.2982 - val_accuracy: 0.8947 - val_auc_2: 0.7631 - val_precision_2: 0.5000 - val_recall_2: 0.0087 - val_balanced_accuracy: 0.5029
Epoch 10/10
35/35 - 0s - loss: 0.3130 - accuracy: 0.8934 - auc_2: 0.6987 - precision_2: 0.3571 - recall_2: 0.0108 - balanced_accuracy: 0.5043 - val_loss: 0.2949 - val_accuracy: 0.8956 - val_auc_2: 0.7706 - val_precision_2: 0.6667 - val_recall_2: 0.0174 - val_balanced_accuracy: 0.5054
Epoch 00010: val_loss improved from inf to 0.29488, saving model to /home/zadubrov/output/results_train/PPARg_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for PPARg: 0.11 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'PPARg single-labeled Fold-0' on test data
INFO     Loss: 0.4463
INFO     Accuracy: 0.8883
INFO     AUC: 0.4868
INFO     Precision: 0.2941
INFO     Recall: 0.0435
INFO     Balanced Accuracy: nan
INFO     MCC: 0.0774
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
35/35 [==============================] - 2s 10ms/step - loss: 0.4463 - accuracy: 0.8883 - auc: 0.4868 - precision: 0.2941 - recall: 0.0435 - balanced_accuracy: nan
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/PPARg_saved_model/assets
INFO     Preparing training data matrices
INFO     Using uncompressed fingerprints
INFO     DataSet has 7248 valid entries in fp and ED
INFO     Fraction sampling is OFF
INFO     Number of sampling values: {0: 5032, 1: 2216}
INFO     X training matrix of shape (7248, 2048) and type bool
INFO     Y training matrix of shape (7248,) and type int16
INFO     Training of fold number: 0
INFO     Initial bias for last sigmoid layer: -0.8198518837784559
INFO     Network type: FNN
INFO     Model: "sequential_2"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_10 (Dense)             (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_8 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_11 (Dense)             (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_9 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_12 (Dense)             (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_10 (AlphaDropo (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_13 (Dense)             (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_11 (AlphaDropo (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_14 (Dense)             (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-03-29 15:22:50.195020: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-03-29 15:22:50.195174: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-03-29 15:22:50.213192: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-03-29 15:22:50.214286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-03-29 15:22:50.215346: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 70 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-03-29 15:22:50.216528: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 70 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-03-29 15:22:50.227743: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.01ms.
  function_optimizer: function_optimizer did nothing. time = 0.002ms.
Epoch 1/10
46/46 - 2s - loss: 0.6737 - accuracy: 0.6475 - auc_2: 0.5169 - precision_2: 0.3408 - recall_2: 0.1636 - balanced_accuracy: 0.5101 - val_loss: 0.5981 - val_accuracy: 0.6972 - val_auc_2: 0.6167 - val_precision_2: 0.5149 - val_recall_2: 0.1558 - val_balanced_accuracy: 0.5477
Epoch 2/10
46/46 - 1s - loss: 0.6384 - accuracy: 0.6618 - auc_2: 0.5756 - precision_2: 0.4000 - recall_2: 0.2121 - balanced_accuracy: 0.5355 - val_loss: 0.5779 - val_accuracy: 0.7186 - val_auc_2: 0.6613 - val_precision_2: 0.6224 - val_recall_2: 0.2009 - val_balanced_accuracy: 0.5757
Epoch 3/10
46/46 - 1s - loss: 0.6115 - accuracy: 0.6818 - auc_2: 0.6186 - precision_2: 0.4641 - recall_2: 0.2628 - balanced_accuracy: 0.5647 - val_loss: 0.5646 - val_accuracy: 0.7228 - val_auc_2: 0.6881 - val_precision_2: 0.6289 - val_recall_2: 0.2257 - val_balanced_accuracy: 0.5858
Epoch 4/10
46/46 - 1s - loss: 0.5970 - accuracy: 0.6971 - auc_2: 0.6411 - precision_2: 0.5087 - recall_2: 0.2798 - balanced_accuracy: 0.5810 - val_loss: 0.5546 - val_accuracy: 0.7290 - val_auc_2: 0.7034 - val_precision_2: 0.6359 - val_recall_2: 0.2641 - val_balanced_accuracy: 0.6003
Epoch 5/10
46/46 - 0s - loss: 0.5719 - accuracy: 0.7128 - auc_2: 0.6826 - precision_2: 0.5516 - recall_2: 0.3254 - balanced_accuracy: 0.6044 - val_loss: 0.5455 - val_accuracy: 0.7324 - val_auc_2: 0.7183 - val_precision_2: 0.6291 - val_recall_2: 0.3025 - val_balanced_accuracy: 0.6118
Epoch 6/10
46/46 - 1s - loss: 0.5721 - accuracy: 0.7127 - auc_2: 0.6816 - precision_2: 0.5524 - recall_2: 0.3181 - balanced_accuracy: 0.6030 - val_loss: 0.5384 - val_accuracy: 0.7352 - val_auc_2: 0.7300 - val_precision_2: 0.6194 - val_recall_2: 0.3454 - val_balanced_accuracy: 0.6276
Epoch 7/10
46/46 - 1s - loss: 0.5631 - accuracy: 0.7158 - auc_2: 0.6967 - precision_2: 0.5582 - recall_2: 0.3378 - balanced_accuracy: 0.6091 - val_loss: 0.5320 - val_accuracy: 0.7407 - val_auc_2: 0.7388 - val_precision_2: 0.6293 - val_recall_2: 0.3679 - val_balanced_accuracy: 0.6363
Epoch 8/10
46/46 - 1s - loss: 0.5434 - accuracy: 0.7385 - auc_2: 0.7233 - precision_2: 0.6198 - recall_2: 0.3751 - balanced_accuracy: 0.6400 - val_loss: 0.5276 - val_accuracy: 0.7428 - val_auc_2: 0.7450 - val_precision_2: 0.6232 - val_recall_2: 0.3995 - val_balanced_accuracy: 0.6469
Epoch 9/10
INFO     Computation time for training the single-label model for ED: 0.13 min
INFO     Network type: FNN
INFO     Model: "sequential"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense (Dense)                (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout (AlphaDropout) (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_1 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_1 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_2 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_2 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_3 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_3 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_4 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
INFO     Evaluating trained model 'ED single-labeled Fold-0' on test data
46/46 - 1s - loss: 0.5423 - accuracy: 0.7320 - auc_2: 0.7270 - precision_2: 0.5995 - recall_2: 0.3723 - balanced_accuracy: 0.6324 - val_loss: 0.5232 - val_accuracy: 0.7476 - val_auc_2: 0.7500 - val_precision_2: 0.6351 - val_recall_2: 0.4086 - val_balanced_accuracy: 0.6524
Epoch 10/10
46/46 - 1s - loss: 0.5341 - accuracy: 0.7408 - auc_2: 0.7363 - precision_2: 0.6227 - recall_2: 0.3864 - balanced_accuracy: 0.6445 - val_loss: 0.5197 - val_accuracy: 0.7490 - val_auc_2: 0.7546 - val_precision_2: 0.6330 - val_recall_2: 0.4244 - val_balanced_accuracy: 0.6579
Epoch 00010: val_loss improved from inf to 0.51970, saving model to /home/zadubrov/output/results_train/ED_single-labeled_Fold-0.model.weights.hdf5
INFO     Loss: 0.6597
INFO     Accuracy: 0.6917
INFO     AUC: 0.4547
INFO     Precision: 0.3571
INFO     Recall: 0.0113
INFO     Balanced Accuracy: 0.5033
INFO     MCC: 0.0111
INFO     Network type: FNN
INFO     Model: "sequential_1"
INFO     _________________________________________________________________
INFO     Layer (type)                 Output Shape              Param #
INFO     =================================================================
INFO     dense_5 (Dense)              (None, 1024)              2098176
INFO     _________________________________________________________________
INFO     alpha_dropout_4 (AlphaDropou (None, 1024)              0
INFO     _________________________________________________________________
INFO     dense_6 (Dense)              (None, 512)               524800
INFO     _________________________________________________________________
INFO     alpha_dropout_5 (AlphaDropou (None, 512)               0
INFO     _________________________________________________________________
INFO     dense_7 (Dense)              (None, 256)               131328
INFO     _________________________________________________________________
INFO     alpha_dropout_6 (AlphaDropou (None, 256)               0
INFO     _________________________________________________________________
INFO     dense_8 (Dense)              (None, 128)               32896
INFO     _________________________________________________________________
INFO     alpha_dropout_7 (AlphaDropou (None, 128)               0
INFO     _________________________________________________________________
INFO     dense_9 (Dense)              (None, 1)                 129
INFO     =================================================================
INFO     Total params: 2,787,329
INFO     Trainable params: 2,787,329
INFO     Non-trainable params: 0
INFO     _________________________________________________________________
46/46 [==============================] - 1s 9ms/step - loss: 0.6597 - accuracy: 0.6917 - auc: 0.4547 - precision: 0.3571 - recall: 0.0113 - balanced_accuracy: 0.5033
INFO:tensorflow:Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets
INFO     Assets written to: /home/zadubrov/output/results_train/ED_saved_model/assets