WARNING:tensorflow:`period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
WARNING  `period` argument is deprecated. Please use `save_freq` to specify the frequency in number of batches seen.
2023-04-26 11:18:50.206608: I tensorflow/core/grappler/devices.cc:66] Number of eligible GPUs (core count >= 8, compute capability >= 0.0): 4
2023-04-26 11:18:50.207301: I tensorflow/core/grappler/clusters/single_machine.cc:357] Starting new session
2023-04-26 11:18:50.231761: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 78600 MB memory:  -> device: 0, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:17:00.0, compute capability: 8.0
2023-04-26 11:18:50.233055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 78600 MB memory:  -> device: 1, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:65:00.0, compute capability: 8.0
2023-04-26 11:18:50.234317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:2 with 78600 MB memory:  -> device: 2, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:ca:00.0, compute capability: 8.0
2023-04-26 11:18:50.235467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:3 with 78600 MB memory:  -> device: 3, name: NVIDIA A100 80GB PCIe, pci bus id: 0000:e3:00.0, compute capability: 8.0
2023-04-26 11:18:50.270575: I tensorflow/core/grappler/optimizers/meta_optimizer.cc:1137] Optimization results for grappler item: graph_to_optimize
  function_optimizer: function_optimizer did nothing. time = 0.066ms.
  function_optimizer: function_optimizer did nothing. time = 0.003ms.
WARNING:tensorflow:From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
WARNING  From /home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py:3777: tensor_shape_from_node_def_name (from tensorflow.python.framework.graph_util_impl) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.graph_util.tensor_shape_from_node_def_name`
Epoch 1/10
2023-04-26 11:18:50.541903: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
37/37 - 7s - loss: 0.5125 - accuracy: 0.8027 - auc: 0.5276 - precision: 0.2364 - recall: 0.0460 - balanced_accuracy: 0.5062 - val_loss: 0.4516 - val_accuracy: 0.8260 - val_auc: 0.6281 - val_precision: 0.8750 - val_recall: 0.0330 - val_balanced_accuracy: 0.5165
Epoch 2/10
37/37 - 0s - loss: 0.4895 - accuracy: 0.8091 - auc: 0.5764 - precision: 0.3596 - recall: 0.0862 - balanced_accuracy: 0.5266 - val_loss: 0.4276 - val_accuracy: 0.8345 - val_auc: 0.6907 - val_precision: 0.8636 - val_recall: 0.0896 - val_balanced_accuracy: 0.5402
Epoch 3/10
2023-04-26 11:18:56.722185: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
37/37 - 0s - loss: 0.4593 - accuracy: 0.8211 - auc: 0.6395 - precision: 0.5000 - recall: 0.1311 - balanced_accuracy: 0.5537 - val_loss: 0.4133 - val_accuracy: 0.8412 - val_auc: 0.7183 - val_precision: 0.9000 - val_recall: 0.1274 - val_balanced_accuracy: 0.5635
Epoch 4/10
37/37 - 0s - loss: 0.4517 - accuracy: 0.8194 - auc: 0.6573 - precision: 0.4828 - recall: 0.1322 - balanced_accuracy: 0.5511 - val_loss: 0.4021 - val_accuracy: 0.8463 - val_auc: 0.7387 - val_precision: 0.8947 - val_recall: 0.1604 - val_balanced_accuracy: 0.5774
Epoch 5/10
37/37 - 0s - loss: 0.4363 - accuracy: 0.8283 - auc: 0.6853 - precision: 0.5659 - recall: 0.1724 - balanced_accuracy: 0.5700 - val_loss: 0.3937 - val_accuracy: 0.8480 - val_auc: 0.7553 - val_precision: 0.8478 - val_recall: 0.1840 - val_balanced_accuracy: 0.5856
Epoch 6/10
37/37 - 0s - loss: 0.4279 - accuracy: 0.8334 - auc: 0.7012 - precision: 0.6160 - recall: 0.1818 - balanced_accuracy: 0.5786 - val_loss: 0.3872 - val_accuracy: 0.8463 - val_auc: 0.7659 - val_precision: 0.8000 - val_recall: 0.1887 - val_balanced_accuracy: 0.5880
Epoch 7/10
37/37 - 0s - loss: 0.4175 - accuracy: 0.8344 - auc: 0.7198 - precision: 0.6105 - recall: 0.2054 - balanced_accuracy: 0.5874 - val_loss: 0.3818 - val_accuracy: 0.8514 - val_auc: 0.7753 - val_precision: 0.8214 - val_recall: 0.2170 - val_balanced_accuracy: 0.6031
Epoch 8/10
37/37 - 0s - loss: 0.4092 - accuracy: 0.8418 - auc: 0.7310 - precision: 0.6667 - recall: 0.2314 - balanced_accuracy: 0.6032 - val_loss: 0.3768 - val_accuracy: 0.8522 - val_auc: 0.7828 - val_precision: 0.8136 - val_recall: 0.2264 - val_balanced_accuracy: 0.6078
Epoch 9/10
37/37 - 0s - loss: 0.4006 - accuracy: 0.8399 - auc: 0.7469 - precision: 0.6606 - recall: 0.2161 - balanced_accuracy: 0.5993 - val_loss: 0.3728 - val_accuracy: 0.8514 - val_auc: 0.7895 - val_precision: 0.7647 - val_recall: 0.2453 - val_balanced_accuracy: 0.6158
Epoch 10/10
37/37 - 0s - loss: 0.3873 - accuracy: 0.8479 - auc: 0.7678 - precision: 0.7096 - recall: 0.2538 - balanced_accuracy: 0.6161 - val_loss: 0.3692 - val_accuracy: 0.8564 - val_auc: 0.7943 - val_precision: 0.7917 - val_recall: 0.2689 - val_balanced_accuracy: 0.6263
Epoch 00010: val_loss improved from inf to 0.36919, saving model to /home/zadubrov/output/results_train/AR_single-labeled_Fold-0.model.weights.hdf5
INFO     Computation time for training the single-label model for AR: 0.21 min
WARNING  Using 4735 background data samples could cause slower run times. Consider using shap.sample(data, K) or shap.kmeans(data, K) to summarize the background as K samples.
  0%|                                                                                                                                    | 0/1184 [00:00<?, ?it/s]
<IPython.core.display.HTML object>
[ True  True  True ...  True  True  True]
<bound method Model.predict of <keras.engine.sequential.Sequential object at 0x2b7b6a198820>>
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
<class 'numpy.ndarray'>	4735
  0%|                                                                                                                                    | 0/1184 [00:00<?, ?it/s]INFO     num_full_subsets = 0
INFO     remaining_weight_vector = [0.12197261 0.06101611 0.0406973  ... 0.00023811 0.00023811 0.00023811]
INFO     num_paired_subset_sizes = 1023
INFO     weight_left = 1.0000000000000002
2023-04-26 11:26:28.596527: W tensorflow/core/common_runtime/bfc_allocator.cc:457] Allocator (GPU_0_bfc) ran out of memory trying to allocate 221.95GiB (rounded to 238320353280)requested by op Cast
If the cause is memory fragmentation maybe the environment variable 'TF_GPU_ALLOCATOR=cuda_malloc_async' will improve the situation.
Current allocation summary follows.
Current allocation summary follows.
2023-04-26 11:26:28.596710: I tensorflow/core/common_runtime/bfc_allocator.cc:1004] BFCAllocator dump for GPU_0_bfc
2023-04-26 11:26:28.596779: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (256): 	Total Chunks: 89, Chunks in use: 88. 22.2KiB allocated for chunks. 22.0KiB in use in bin. 324B client-requested in use in bin.
2023-04-26 11:26:28.596827: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (512): 	Total Chunks: 7, Chunks in use: 6. 3.5KiB allocated for chunks. 3.0KiB in use in bin. 3.0KiB client-requested in use in bin.
2023-04-26 11:26:28.596870: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (1024): 	Total Chunks: 8, Chunks in use: 8. 8.2KiB allocated for chunks. 8.2KiB in use in bin. 7.1KiB client-requested in use in bin.
2023-04-26 11:26:28.596955: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (2048): 	Total Chunks: 6, Chunks in use: 4. 12.5KiB allocated for chunks. 8.5KiB in use in bin. 8.3KiB client-requested in use in bin.
2023-04-26 11:26:28.596999: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (4096): 	Total Chunks: 3, Chunks in use: 3. 12.0KiB allocated for chunks. 12.0KiB in use in bin. 12.0KiB client-requested in use in bin.
2023-04-26 11:26:28.597040: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (8192): 	Total Chunks: 1, Chunks in use: 1. 9.2KiB allocated for chunks. 9.2KiB in use in bin. 9.2KiB client-requested in use in bin.
2023-04-26 11:26:28.597106: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597145: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (32768): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597206: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597273: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (131072): 	Total Chunks: 3, Chunks in use: 3. 485.8KiB allocated for chunks. 485.8KiB in use in bin. 384.0KiB client-requested in use in bin.
2023-04-26 11:26:28.597318: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597382: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (524288): 	Total Chunks: 3, Chunks in use: 3. 1.62MiB allocated for chunks. 1.62MiB in use in bin. 1.50MiB client-requested in use in bin.
2023-04-26 11:26:28.597443: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597486: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (2097152): 	Total Chunks: 3, Chunks in use: 3. 6.50MiB allocated for chunks. 6.50MiB in use in bin. 6.00MiB client-requested in use in bin.
2023-04-26 11:26:28.597529: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (4194304): 	Total Chunks: 1, Chunks in use: 1. 4.50MiB allocated for chunks. 4.50MiB in use in bin. 2.31MiB client-requested in use in bin.
2023-04-26 11:26:28.597596: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (8388608): 	Total Chunks: 4, Chunks in use: 4. 34.00MiB allocated for chunks. 34.00MiB in use in bin. 33.25MiB client-requested in use in bin.
2023-04-26 11:26:28.597645: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (16777216): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597689: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597728: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597774: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2023-04-26 11:26:28.597819: I tensorflow/core/common_runtime/bfc_allocator.cc:1011] Bin (268435456): 	Total Chunks: 2, Chunks in use: 1. 76.71GiB allocated for chunks. 55.49GiB in use in bin. 55.49GiB client-requested in use in bin.
2023-04-26 11:26:28.597866: I tensorflow/core/common_runtime/bfc_allocator.cc:1027] Bin for 221.95GiB was 256.00MiB, Chunk State:
2023-04-26 11:26:28.598051: I tensorflow/core/common_runtime/bfc_allocator.cc:1033]   Size: 21.22GiB | Requested Size: 1.0KiB | in_use: 0 | bin_num: 20, prev:   Size: 55.49GiB | Requested Size: 55.49GiB | in_use: 1 | bin_num: -1
2023-04-26 11:26:28.598093: I tensorflow/core/common_runtime/bfc_allocator.cc:1040] Next region of size 82418335744
2023-04-26 11:26:28.598125: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000000 of size 256 next 1
2023-04-26 11:26:28.598159: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000100 of size 1280 next 2
2023-04-26 11:26:28.598187: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000600 of size 256 next 3
2023-04-26 11:26:28.598214: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000700 of size 256 next 4
2023-04-26 11:26:28.598257: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000800 of size 256 next 5
2023-04-26 11:26:28.598289: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8000900 of size 4096 next 8
2023-04-26 11:26:28.598316: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8001900 of size 256 next 9
2023-04-26 11:26:28.598343: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8001a00 of size 2048 next 10
2023-04-26 11:26:28.598372: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002200 of size 256 next 13
2023-04-26 11:26:28.598399: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002300 of size 1024 next 14
2023-04-26 11:26:28.598427: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002700 of size 256 next 17
2023-04-26 11:26:28.598455: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002800 of size 512 next 18
2023-04-26 11:26:28.598482: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002a00 of size 256 next 21
2023-04-26 11:26:28.598517: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002b00 of size 256 next 22
2023-04-26 11:26:28.598543: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002c00 of size 256 next 23
2023-04-26 11:26:28.598571: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002d00 of size 256 next 24
2023-04-26 11:26:28.598597: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002e00 of size 256 next 27
2023-04-26 11:26:28.598624: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8002f00 of size 256 next 32
2023-04-26 11:26:28.598657: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003000 of size 256 next 25
2023-04-26 11:26:28.598684: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003100 of size 512 next 26
2023-04-26 11:26:28.598710: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003300 of size 256 next 155
2023-04-26 11:26:28.598737: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003400 of size 256 next 154
2023-04-26 11:26:28.598764: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003500 of size 256 next 114
2023-04-26 11:26:28.598791: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] Free  at 2b7ea8003600 of size 2048 next 141
2023-04-26 11:26:28.598826: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003e00 of size 256 next 30
2023-04-26 11:26:28.598852: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8003f00 of size 256 next 143
2023-04-26 11:26:28.598879: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004000 of size 256 next 126
2023-04-26 11:26:28.598907: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004100 of size 256 next 139
2023-04-26 11:26:28.598933: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004200 of size 256 next 120
2023-04-26 11:26:28.598967: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004300 of size 256 next 130
2023-04-26 11:26:28.598993: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004400 of size 256 next 34
2023-04-26 11:26:28.599020: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004500 of size 256 next 35
2023-04-26 11:26:28.599047: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004600 of size 256 next 36
2023-04-26 11:26:28.599072: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004700 of size 256 next 37
2023-04-26 11:26:28.599099: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8004800 of size 9472 next 38
2023-04-26 11:26:28.599126: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8006d00 of size 256 next 39
2023-04-26 11:26:28.599153: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8006e00 of size 256 next 40
2023-04-26 11:26:28.599181: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8006f00 of size 256 next 41
2023-04-26 11:26:28.599207: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007000 of size 256 next 42
2023-04-26 11:26:28.599233: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007100 of size 256 next 43
2023-04-26 11:26:28.599270: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007200 of size 256 next 44
2023-04-26 11:26:28.599303: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007300 of size 256 next 45
2023-04-26 11:26:28.599331: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007400 of size 256 next 46
2023-04-26 11:26:28.599359: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8007500 of size 4096 next 48
2023-04-26 11:26:28.599386: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8008500 of size 2048 next 49
2023-04-26 11:26:28.599414: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8008d00 of size 1024 next 50
2023-04-26 11:26:28.599442: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8009100 of size 235264 next 19
2023-04-26 11:26:28.599471: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8042800 of size 131072 next 20
2023-04-26 11:26:28.599499: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8062800 of size 654080 next 15
2023-04-26 11:26:28.599530: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8102300 of size 524288 next 16
2023-04-26 11:26:28.599561: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8182300 of size 2619136 next 11
2023-04-26 11:26:28.599588: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8401a00 of size 2097152 next 12
2023-04-26 11:26:28.599618: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea8601a00 of size 10481152 next 6
2023-04-26 11:26:28.599646: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea9000800 of size 8388608 next 7
2023-04-26 11:26:28.599673: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7ea9800800 of size 8388608 next 47
2023-04-26 11:26:28.599701: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa000800 of size 512 next 51
2023-04-26 11:26:28.599729: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa000a00 of size 512 next 52
2023-04-26 11:26:28.599755: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa000c00 of size 256 next 53
2023-04-26 11:26:28.599782: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa000d00 of size 8388608 next 54
2023-04-26 11:26:28.599810: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa800d00 of size 4096 next 55
2023-04-26 11:26:28.599840: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaa801d00 of size 2097152 next 56
2023-04-26 11:26:28.599867: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaa01d00 of size 2048 next 57
2023-04-26 11:26:28.599896: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaa02500 of size 524288 next 58
2023-04-26 11:26:28.599929: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaa82500 of size 1024 next 59
2023-04-26 11:26:28.599956: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaa82900 of size 131072 next 60
2023-04-26 11:26:28.599985: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa2900 of size 512 next 61
2023-04-26 11:26:28.600013: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa2b00 of size 512 next 62
2023-04-26 11:26:28.600040: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa2d00 of size 256 next 63
2023-04-26 11:26:28.600067: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa2e00 of size 256 next 64
2023-04-26 11:26:28.600094: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa2f00 of size 256 next 65
2023-04-26 11:26:28.600121: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3000 of size 256 next 66
2023-04-26 11:26:28.600149: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3100 of size 256 next 67
2023-04-26 11:26:28.600176: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3200 of size 256 next 68
2023-04-26 11:26:28.600202: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3300 of size 256 next 69
2023-04-26 11:26:28.600237: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3400 of size 256 next 70
2023-04-26 11:26:28.600273: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3500 of size 256 next 71
2023-04-26 11:26:28.600299: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3600 of size 256 next 72
2023-04-26 11:26:28.600326: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3700 of size 256 next 73
2023-04-26 11:26:28.600359: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3800 of size 256 next 74
2023-04-26 11:26:28.600385: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3900 of size 256 next 75
2023-04-26 11:26:28.600411: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3a00 of size 256 next 76
2023-04-26 11:26:28.600438: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3b00 of size 256 next 77
2023-04-26 11:26:28.600471: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3c00 of size 256 next 78
2023-04-26 11:26:28.600497: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3d00 of size 256 next 79
2023-04-26 11:26:28.600523: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3e00 of size 256 next 80
2023-04-26 11:26:28.600549: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa3f00 of size 256 next 81
2023-04-26 11:26:28.600583: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4000 of size 256 next 82
2023-04-26 11:26:28.600611: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4100 of size 256 next 83
2023-04-26 11:26:28.600638: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4200 of size 256 next 84
2023-04-26 11:26:28.600665: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4300 of size 256 next 85
2023-04-26 11:26:28.600692: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4400 of size 256 next 86
2023-04-26 11:26:28.600718: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4500 of size 256 next 87
2023-04-26 11:26:28.600746: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4600 of size 256 next 88
2023-04-26 11:26:28.600779: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4700 of size 256 next 89
2023-04-26 11:26:28.600806: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4800 of size 256 next 90
2023-04-26 11:26:28.600833: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4900 of size 256 next 91
2023-04-26 11:26:28.600862: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4a00 of size 256 next 92
2023-04-26 11:26:28.600890: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4b00 of size 256 next 93
2023-04-26 11:26:28.600917: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4c00 of size 256 next 94
2023-04-26 11:26:28.600944: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4d00 of size 256 next 95
2023-04-26 11:26:28.600971: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4e00 of size 256 next 96
2023-04-26 11:26:28.600997: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa4f00 of size 256 next 97
2023-04-26 11:26:28.601024: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5000 of size 256 next 98
2023-04-26 11:26:28.601050: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5100 of size 256 next 99
2023-04-26 11:26:28.601079: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5200 of size 256 next 100
2023-04-26 11:26:28.601115: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5300 of size 256 next 108
2023-04-26 11:26:28.601144: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5400 of size 256 next 33
2023-04-26 11:26:28.601178: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5500 of size 256 next 146
2023-04-26 11:26:28.601204: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5600 of size 256 next 117
2023-04-26 11:26:28.601230: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5700 of size 1024 next 111
2023-04-26 11:26:28.601264: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5b00 of size 256 next 112
2023-04-26 11:26:28.601292: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] Free  at 2b7eaaaa5c00 of size 512 next 148
2023-04-26 11:26:28.601318: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5e00 of size 256 next 107
2023-04-26 11:26:28.601345: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa5f00 of size 256 next 113
2023-04-26 11:26:28.601373: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa6000 of size 256 next 106
2023-04-26 11:26:28.601400: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa6100 of size 256 next 129
2023-04-26 11:26:28.601428: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaaa6200 of size 4719104 next 118
2023-04-26 11:26:28.601455: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] Free  at 2b7eaaf26400 of size 256 next 140
2023-04-26 11:26:28.601483: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf26500 of size 2560 next 110
2023-04-26 11:26:28.601512: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf26f00 of size 1024 next 137
2023-04-26 11:26:28.601538: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf27300 of size 256 next 127
2023-04-26 11:26:28.601572: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf27400 of size 256 next 121
2023-04-26 11:26:28.601598: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf27500 of size 256 next 125
2023-04-26 11:26:28.601626: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf27600 of size 256 next 136
2023-04-26 11:26:28.601659: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf27700 of size 256 next 102
2023-04-26 11:26:28.601685: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] Free  at 2b7eaaf27800 of size 2048 next 123
2023-04-26 11:26:28.601712: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf28000 of size 1024 next 105
2023-04-26 11:26:28.601739: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf28400 of size 1024 next 157
2023-04-26 11:26:28.601767: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] InUse at 2b7eaaf28800 of size 59580088320 next 144
2023-04-26 11:26:28.601796: I tensorflow/core/common_runtime/bfc_allocator.cc:1060] Free  at 2b8c8a328800 of size 22788798464 next 18446744073709551615
2023-04-26 11:26:28.601828: I tensorflow/core/common_runtime/bfc_allocator.cc:1065]      Summary of in-use Chunks by size:
2023-04-26 11:26:28.601860: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 88 Chunks of size 256 totalling 22.0KiB
2023-04-26 11:26:28.601896: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 6 Chunks of size 512 totalling 3.0KiB
2023-04-26 11:26:28.601924: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 7 Chunks of size 1024 totalling 7.0KiB
2023-04-26 11:26:28.601957: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 1280 totalling 1.2KiB
2023-04-26 11:26:28.601994: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 3 Chunks of size 2048 totalling 6.0KiB
2023-04-26 11:26:28.602027: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 2560 totalling 2.5KiB
2023-04-26 11:26:28.602056: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 3 Chunks of size 4096 totalling 12.0KiB
2023-04-26 11:26:28.602084: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 9472 totalling 9.2KiB
2023-04-26 11:26:28.602114: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 2 Chunks of size 131072 totalling 256.0KiB
2023-04-26 11:26:28.602146: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 235264 totalling 229.8KiB
2023-04-26 11:26:28.602177: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 2 Chunks of size 524288 totalling 1.00MiB
2023-04-26 11:26:28.602206: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 654080 totalling 638.8KiB
2023-04-26 11:26:28.602235: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 2 Chunks of size 2097152 totalling 4.00MiB
2023-04-26 11:26:28.602271: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 2619136 totalling 2.50MiB
2023-04-26 11:26:28.602300: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 4719104 totalling 4.50MiB
2023-04-26 11:26:28.602330: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 3 Chunks of size 8388608 totalling 24.00MiB
2023-04-26 11:26:28.602361: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 10481152 totalling 10.00MiB
2023-04-26 11:26:28.602392: I tensorflow/core/common_runtime/bfc_allocator.cc:1068] 1 Chunks of size 59580088320 totalling 55.49GiB
2023-04-26 11:26:28.602423: I tensorflow/core/common_runtime/bfc_allocator.cc:1072] Sum Total of in-use chunks: 55.53GiB
2023-04-26 11:26:28.602454: I tensorflow/core/common_runtime/bfc_allocator.cc:1074] total_region_allocated_bytes_: 82418335744 memory_limit_: 82418335744 available bytes: 0 curr_region_allocation_bytes_: 164836671488
2023-04-26 11:26:28.602498: I tensorflow/core/common_runtime/bfc_allocator.cc:1080] Stats:
Limit:                     82418335744
InUse:                     59629532416
MaxInUse:                  59629532416
NumAllocs:                       52887
MaxAllocSize:              59580088320
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0
2023-04-26 11:26:28.602635: W tensorflow/core/common_runtime/bfc_allocator.cc:468] *************************************************************************___________________________
2023-04-26 11:26:28.602753: W tensorflow/core/framework/op_kernel.cc:1680] Resource exhausted: failed to allocate memory
  0%|                                                                                                                                    | 0/1184 [07:24<?, ?it/s]
Traceback (most recent call last):
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/__main__.py", line 415, in <module>
    main()
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/__main__.py", line 392, in main
    train(fixed_opts)
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/__main__.py", line 190, in train
    sl.train_single_label_models(df=df, opts=opts)
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/single_label_model.py", line 551, in train_single_label_models
    performance = fit_and_evaluate_model(x_train=x_train, x_test=x_test, y_train=y_train, y_test=y_test,
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/single_label_model.py", line 422, in fit_and_evaluate_model
    sd.shap_explain(x_train, x_test, model, target, opts.outputDir, drop_values=True, threshold=10, save_values=True)
  File "/gpfs0/home/zadubrov/deepFPlearn_exai/dfpl/shap_dfpl.py", line 27, in shap_explain
    shap_values, indices = explainer.shap_values(x_test)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/shap/explainers/_kernel.py", line 190, in shap_values
    explanations.append(self.explain(data, **kwargs))
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/shap/explainers/_kernel.py", line 382, in explain
    self.run()
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/shap/explainers/_kernel.py", line 521, in run
    modelOut = self.model.f(data)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/keras/engine/base_layer.py", line 1037, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/keras/engine/sequential.py", line 369, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/keras/engine/functional.py", line 414, in call
    return self._run_internal_graph(
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/keras/engine/functional.py", line 532, in _run_internal_graph
    y = self._conform_to_reference_input(y, ref_input=x)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/keras/engine/functional.py", line 632, in _conform_to_reference_input
    tensor = tf.cast(tensor, dtype=ref_input.dtype)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/util/dispatch.py", line 206, in wrapper
    return target(*args, **kwargs)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/math_ops.py", line 990, in cast
    x = gen_math_ops.cast(x, base_type, name=name)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/ops/gen_math_ops.py", line 1943, in cast
    _ops.raise_from_not_ok_status(e, name)
  File "/home/zadubrov/.conda/envs/dfpl_exai/lib/python3.9/site-packages/tensorflow/python/framework/ops.py", line 6941, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: failed to allocate memory [Op:Cast]